# S-SOM v1.0: 天候型付けのための構造的自己組織化マップ・アルゴリズム（日本語訳）

本ファイルは PDF「gmd-14-2097-2021.pdf」の内容を可能な限り正確に日本語訳したものです。PDF の性質上、図・表・数式・レイアウトに崩れや欠落がある場合があります。図（Fig.1–A10）は本文の説明とキャプションにより反映しています。引用・DOI・ライセンス情報は原文準拠です。

- 書誌情報:
  - Geosci. Model Dev., 14, 2097–2111, 2021
  - https://doi.org/10.5194/gmd-14-2097-2021
  - © Author(s) 2021. CC BY 4.0

- タイトル: S-SOM v1.0: a structural self-organizing map algorithm for weather typing
- 著者: Quang-Van Doan, Hiroyuki Kusaka, Takuto Sato, Fei Chen
- 所属:
  - 1: 筑波大学 計算科学研究センター（日本）
  - 2: 筑波大学 生命環境科学研究科（日本）
  - 3: NCAR（米国）
- 連絡先: doan.van.gb@u.tsukuba.ac.jp
- 受理履歴: 受理 2021/2/17、公開 2021/4/22（査読過程: 2020/8/18 受付、2020/10/9 議論開始、2021/1/15 改訂）

---

要旨（Abstract）

本研究は、総観天候型付けのための新規な構造的自己組織化マップ（S-SOM）アルゴリズムを提案する。S-SOM の新規性は、空間・時間的構造を持つ入力データを扱える点にある。具体的には、S-SOM における BMU（Best Matching Unit）探索を、従来のユークリッド距離（ED）ではなく構造的類似度（S-SIM）指標に基づいて実施する。S-SIM は、ED では困難な、例えば高低気圧の位置などに関わる空間相関を考慮した BMU 探索を可能にする。S-SOM の性能は、日本域の ERA-Interim の海面更正気圧（SLP）を用いた複数のデモ・クラスタリング実験で評価した。結果は、（1）シルエット解析に基づくクラスタリングの質、（2）トポロジ誤差（topological error: TE）に基づくトポロジ保持の 2 点で、S-SOM が ED を用いる標準 SOM（ED-SOM）より優れていることを示した。この優位性は、テスト内容やノードサイズ構成が異なる場合でも一貫して観察された。また、S-SOM はピアソン相関係数を用いる SOM（COR-SOM）よりも良い性能を示すが、その差は ED-SOM との比較ほど明瞭ではなかった。

---

1. 序論（Introduction）

近年、気候学における SOM（自己組織化マップ）の応用が増加している。SOM（Kohonen, 1982）は教師なしデータマイニング手法であり、入力データの内在パターンを低次元マップへ写像し、マップ上のノードが入力空間の重要特徴を表す。総観気候学における標準的応用は、SLP やジオポテンシャル高度などの循環データから、シーケンス解析で扱いやすい少数の代表的天候状態を生成する「客観的」天候型付けである。

SOM の応用は、循環と気候変動性の関係探求、統計的ダウンスケーリング、気候予測や天気予測など多岐にわたる。例として、Horton et al. (2015) は 1980 年代以降のジオポテンシャルパターン頻度変化が北半球の極端な気温トレンドを修飾したことを示した。降水変化と大規模循環パターンのシフトの関連（Alexander et al., 2010; Lennard and Hegerl, 2015; Swales et al., 2016; Nguyen-Le and Yamada, 2019; Luong et al., 2020）や、将来気候のダウンスケーリング（Gibson et al., 2016; Ohba and Sugimoto, 2019）にも用いられている。季節内変動の確率予測（Borah et al., 2013）、降雨ナウキャスト（Chang et al., 2014）、九州での豪雨予測（Nguyen-Le et al., 2017）、風力ランプの中期予測（Ohba et al., 2018）、米国での実時間極端山火事天候予測（Lagerquist et al., 2017）などの応用が報告されている。

SOM は、学習率と近傍関数により、入力ベクトルに最も「類似」する BMU を探索・更新する反復学習でノードを更新し、安定解へ収束させる。BMU 探索は最終結果の品質に大きく影響する。従来の SOM では BMU 探索にユークリッド距離（ED）を用いるが、ED は時間・空間的秩序を持つ信号（時系列、2 次元場）の比較において欠点がある（Wang and Bovik, 2009）。気象・気候データは構造化されており、ED に基づく類似度は高低気圧の位置などの空間相関を劣化させうる（Fig. A1）。既存の SOM 変種（Kaski, 1997; Shah-Hosseini and Safabakhsh, 2003; Shah-Hosseini, 2011）は、主に学習率や近傍関数等のパラメータ化に焦点があり、BMU 探索における ED の根本課題は扱ってこなかった。

以上を踏まえ、本研究は構造的 SOM（S-SOM）を提案する。S-SOM は、構造的類似度（S-SIM）指標に基づく BMU 探索を導入し、空間・時間的関係を持つ入力データを扱える。

---

2. 構造的 SOM アルゴリズム（Structural SOM algorithm）

S-SOM の全体フローは Fig. 1 に示す。Kohonen（1982）に基づき、構成と初期化、訓練反復（入力選択、BMU 探索、ノード更新）からなる。S-SOM と従来実装の差は BMU 探索スキームにあり、ED に代えて構造的類似度 S-SIM を用いる。

S-SIM（Wang et al., 2004）は、画像等の構造的信号において ED より優れた類似認識能力を示す。「輝度（l）」「コントラスト（c）」「構造（s）」の 3 要素に基づき、2 ベクトル x,y の比較を行う。

基本式:
```
S-SIM(x, y) = [ l(x,y)^α × c(x,y)^β × s(x,y)^γ ]            (1)

l(x,y) = (2 μ_x μ_y + c1) / (μ_x^2 + μ_y^2 + c1)            (2)
c(x,y) = (2 σ_x σ_y + c2) / (σ_x^2 + σ_y^2 + c2)            (3)
s(x,y) = (σ_xy + c3) / (σ_x σ_y + c3)                       (4)
```

本研究では簡略化のため c1=c2=c3=0、α=β=γ=1 とし、次式に還元する:
```
S-SIM(x,y) = (2 μ_x μ_y) (σ_xy) / ( (μ_x^2 + μ_y^2) (σ_x^2 + σ_y^2) )     (5)
```

S-SIM は [−1,1] の範囲をとり、1 が完全一致を意味する。

S-SOM の BMU 探索は、SOM ノード間の競合により、入力ベクトルに対して S-SIM 値が最大のノードを BMU とする。以降の学習は従来どおり（学習率と近傍関数で BMU とその近傍を更新）。

---

3. モデル設定と品質評価（Model configuration and quality measurements）

3.1 データと実験設定

ERA-Interim（Dee et al., 2011）の日平均 SLP（1979–2019）を、日本域（20–50°N, 115–165°E、Fig. 2）で使用。元の 0.75°正規格子を 100 km の等面積グリッドに内挿（高緯度で一般的: Lynch et al., 2016; Gibson et al., 2017）。季節ごとに分割（DJF, MAM, JJA, SON）。SOM は一次元ノードで、反復 5,000、初期学習率 0.01（指数減衰）、近傍関数はガウス、初期化はランダム。ノード数 n=4,5,…,20 を試行。100 超のノードではクラスタリングが非効率であることを確認。比較のため、ED-SOM（ED）と COR-SOM（ピアソン相関）も同条件で実施。合計 4（季節）×17（ノード）×3（手法）= 204 実行。

3.2 品質評価

- クラスタリング能力: シルエット解析（Rousseeuw, 1987）
  - 各サンプルでクラスタ内平均距離 a と最近傍クラスタ平均距離 b から s=(b−a)/max(a,b) を算出。s∈[−1,1]。高いほど良好。
- トポロジ保持: トポロジ誤差（TE; Gibson et al., 2017）
  - BMU と 2 番目 BMU（SMU）が隣接なら保持、非隣接なら誤差。全入力の平均で TE を定義。値が小さいほど良好（論文内では、BMU–SMU が近接＝望ましい、図では値の低さが望ましさを示す。本文の表現に揺れがあるが、図解の解釈に基づき「低いほど良い」と読むのが妥当）。

---

4. 結果（Results）

まず、S-SIM、COR、−ED（距離の逆数的な意味での類似度）により、SLP マップ間の類似度 PDF を比較（Fig. 3）。各季節（DJF/MAM/JJA/SON）の全ペアについて類似度を 0–1 に正規化し PDF を作成。

- 要点 1: S-SIM と COR の標準偏差は 0.17–0.19 と、ED の 0.09–0.10 より大きく（Table 1）、サンプル間差異の識別力が高い。
- 要点 2: S-SIM と COR の PDF 形状は季節で変化するが、ED はほぼ一定。すなわち S-SIM と COR は季節変動を識別できるが、ED はできない。DJF/JJA では平均が高く、負の歪度が大きい（優勢な冬型・夏型パターンが多い）。MAM/SON は遷移期でバラエティが大きく、歪度が 0 に近い。

次に、SOM による季節別の型付け結果の物理妥当性を確認。Fig. 4 は DJF（ノード 4）の SLP 型付け結果。日本の冬季はシベリア高気圧とアリューシャン低気圧が卓越し（西高東低）、北西風により日本海側で多雪・太平洋側で晴天（JMA リンク参照）。S-SOM, COR-SOM, ED-SOM いずれも支配的な冬型パターンを検出。

興味深い差異として、S-SOM は「秩序だった」クラスタリング（1 つの支配的ノード + 非支配的ノード）を与える一方（Fig. 4e）、COR/ED はクラスタサイズが相対的に均等（フラット）である（Fig. 4j, o）。これは他のノード数でも一貫。JJA でも認められるが程度は弱い（Fig. A3）。MAM/SON は遷移期で差は明瞭でない。

シルエット解析（Fig. 5, Fig. 6）では、S-SOM と COR-SOM は一貫して ED-SOM より良好。特に DJF で、S-SOM は支配的な冬型 + 例外的パターンという分解を与え、クラスタ厚の差が顕著。一般に大クラスタは誤割当の懸念があるが、それでも S-SOM のシルエット値は COR/ED より高い傾向。Fig. 6 では、（i）S-SOM は全季節・全ノード構成で ED-SOM を上回り、COR-SOM は MAM/SON では S-SOM と同等だが DJF/JJA の一部で劣る、（ii）S-SOM/COR-SOM は季節変動があるが、ED-SOM はほぼ一定。S-SOM は DJF で最も高評価。

トポロジ誤差（Fig. 7）でも、S-SOM は（部分的に COR-SOM も）ED-SOM より低誤差（良好）だが、差はシルエットほど明瞭ではない。MAM/JJA では多くのノード構成で S/COR が低誤差。DJF でノードが小さい場合（4–5）には S-SOM の誤差がやや大きいこともある。SON は差が小さい。TE は近傍関数に強く依存することが知られ、類似度指標の影響は相対的に小さい可能性。

風ベクトル（500 hPa）でも追加検証（Fig. A8–A9）。東西・南北成分を結合し SOM 入力としたところ、シルエット・TE の両面で S/COR が ED を上回り、SLP 実験と整合。

計算時間（Fig. 8）: DJF 実験、入力 3,669 サンプル（65×72 ピクセル）、反復 5,000 の条件で、ED-SOM はノード 4–20 で 1–3 秒、S-SOM/COR-SOM は 8–40 秒（ED の 8–15 倍）。ただし全体でも 1 分未満であり、NWP や将来投影のような重負荷にはならない。

---

5. 結論と備考（Conclusions and remarks）

本研究は、S-SIM による BMU 探索を導入した新 SOM アルゴリズム S-SOM を提案し、日本域の SLP・風ベクトルに対するクラスタリング実験で評価した。S-SOM は、クラスタリング品質（シルエット）とトポロジ保持（TE）の両面で、ED-SOM より優れた性能を示し、ノード構成やテスト内容が変わっても一貫した。COR-SOMよりも概して良好だが、差は ED との比較ほど顕著ではない。

S-SOM（および一部 COR-SOM）は、空間分布を持つ入力データに対して、従来の ED-SOM より効果的である。今後、シルエット・TE 以外の評価指標での検証、時系列への適用（S-SOM の時間データへの有用性の検証）、気候学以外の分野への展開が期待される。構造的入力データに対処する SOM の新しい標準となりうる。

---

付録（Appendix）概要

- Fig. A1: ED の欠点の例示（高低の位置関係が異なるパターン間で ED は同じになりうるが、S-SIM は差を識別）
- Fig. A2–A4: MAM/JJA/SON の SLP パターン（S-SOM/COR-SOM/ED-SOM）
- Fig. A5–A7: MAM/JJA/SON のシルエット・プロット（ノード 4）
- Fig. A8–A9: 冬季 500 hPa 風ベクトルの空間パターンと性能（シルエット/TE）
- Fig. A10: SOM サイズごとの平均シルエットスコア

---

コード・データの入手先（Code and data availability）

本論文で用いたモデルの正確なバージョン、入力データ、実行スクリプト、可視化スクリプトは Zenodo に保存されている。
- Doan (2021): https://doi.org/10.5281/zenodo.4437954

---

著者貢献（Author contributions）

- QVD がモデルを設計しコードを開発。HK/TS がテスト設計を支援。HK/TS/FC が結果解析を支援。QVD が原稿を作成し、各著者が貢献。

競合利益（Competing interests）

- なし。

資金情報（Financial support）

- 環境再生保全機構の環境研究総合推進費（JPMEERF20192005）
- JSPS KAKENHI（JP20K13258, JP19H01155）
- NCAR Water System Program, NASA IDS（80NSSC20K1262）, USDA NIFA（2015-67003-23508, 2015-67003-23460）, NOAA（NA18OAR4590398）, NSF（1739705）

査読（Review statement）

- 編集: David Topping、匿名査読 2 名。

---

参考文献（References）

（本文に掲載の文献を原文のとおり列挙）

Alexander, L. V., et al., 2010. J. Climate, 23, 1111–1126.  
Borah, N., et al., 2013. JGR-Atmos., 118, 9022–9034.  
Chang, L.-C., et al., 2014. J. Hydrol., 519, 476–489.  
Dee, D. P., et al., 2011. QJRMS, 137, 553–597.  
Doan, Q. V., 2021. Zenodo, https://doi.org/10.5281/zenodo.4437954  
Gibson, P. B., et al., 2016. Int. J. Climatol., 36, 3934–3948.  
Gibson, P. B., et al., 2017. JGR-Atmos., 122, 3891–3903.  
Han, F., Szunyogh, I., 2018. Mon. Weather Rev., 146, 1303–1318.  
Horton, D. E., et al., 2015. Nature, 522, 465–469.  
Kaski, S., 1997. Acta Polytechnica Scandinavica No. 82.  
Kohonen, T., 1982. In: Competition and cooperation in neural nets, 248–266.  
Lagerquist, R., et al., 2017. Can. J. For. Res., 47, 1175–1183.  
Lennard, C., Hegerl, G., 2015. Clim. Dyn., 44, 861–879.  
Luong, T. M., et al., 2020. Atmos. Sci. Lett., 21, e981.  
Lynch, A. H., et al., 2016. JGR-Atmos., 121, 7868–7880.  
Mo, R., et al., 2014. J. Hydrometeorol., 15, 1862–1880.  
Nguyen-Le, D., Yamada, T. J., 2019. Weather Forecast., 34, 345–360.  
Nguyen-Le, D., et al., 2017. Atmos. Sci. Lett., 18, 324–329.  
Ohba, M., Sugimoto, S., 2019. Clim. Dyn., 52, 4177–4191.  
Ohba, M., et al., 2018. Atmosphere, 9, 423.  
Rousseeuw, P. J., 1987. J. Comput. Appl. Math., 20, 53–65.  
Shah-Hosseini, H., 2011. Neurocomputing, 74, 1823–1839.  
Shah-Hosseini, H., Safabakhsh, R., 2003. IEEE TSMC-B, 33, 271–282.  
Sheridan, S. C., Lee, C. C., 2011. Prog. Phys. Geogr., 35, 109–119.  
Swales, D., et al., 2016. Geophys. Res. Lett., 43, 1727–1735.  
Wang, Z., Bovik, A. C., 2009. IEEE Signal Process. Mag., 26, 98–117.  
Wang, Z., et al., 2004. IEEE TIP, 13, 600–612.
