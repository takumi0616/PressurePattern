# Self-Organizing Mapsを用いた気圧配置のクラスタリングと1kmメッシュ気象データを用いた解析

## 論文情報
- **著者**: 髙須賀拓海†、高野雄樹‡、渡邉将太郎‡、雲井元道†
- **所属**: 
  - †長岡技術科学大学
  - ‡ウェザーマップ株式会社
- **発表**: 2024年IPSJ全国大会
- **英文タイトル**: Clustering of Atmospheric Pressure Patterns using Self-Organizing Maps and Analysis using 1km mesh weather data

## 1. 概要

本研究は、Self-Organizing Maps (SOM) [1]を用いた気圧配置のクラスタリング手法と、1kmメッシュ気象データを用いた解析を提案している。気象データの詳細な分析を通じて、より精緻な気象パターンの理解を目指す研究である。

## 2. 背景と動機

従来の気象データ分析では、SVMなどの手法[2]が用いられてきたが、本研究ではSOMを採用することで、気圧配置パターンの視覚的な理解と分類を可能にしている。

特に、1kmメッシュという高解像度の気象データを活用することで、より詳細な気象現象の把握が期待される。

## 3. 研究手法

### 3.1 手法の概要

研究は2つのステップで構成される：

#### Step 1: SOMによるクラスタリング
- **前処理**: PCA（主成分分析）により20次元に削減
- **SOM構成**: 10×10のBatch SOMを使用（計100個のクラスタ）
- **パラメータ設定**:
  - σ（シグマ）: 3.0から1.0まで変化
  - 学習回数: 100,000回

結果として、100個の気圧配置クラスタを得る（図4参照）。

#### Step 2: 各クラスタの特徴分析
各クラスタについて、以下の3つの観点から分析を実施：
- 発生頻度
- 発生時期
- 気象的特徴

## 4. 実験設定

### 4.1 データセット

- **期間**: 2016年3月1日から2024年10月31日まで
- **時刻**: 毎日9時（JST）のデータ
- **総データ数**: 3,193日分
- **使用データ**: 15m間隔の555ポイント
  - 緯度: 115°〜155°
  - 高度データも含む
- **GPVデータ**: 386次元
  - 内訳: 海面更正気圧323次元、地上気圧271次元、500hPa高度441次元

### 4.2 詳細データ
1kmメッシュの気象データとして、以下の3要素を分析：
- 日照時間: 2,347地点
- 日平均気温: 12,214地点
- 日降水量: 61地点

### 4.3 PCAとSOMの実装

**訓練データ**:
- 期間: 1981年1月1日から2000年12月31日まで
- 時刻: 毎日9時（JST）
- データ数: 100日分（3か月ごとに選択）
- データソース: JRA-3Q[4]
- グリッド: 緯度経度2.5度グリッドのBグリッド
- 合計: 100次元

SOMの実装には、既存のライブラリ[1]を使用している。

## 5. 結果

### 5.1 SOMによるクラスタリング結果
図1にSOMによって得られた気圧配置クラスタを示す。SOMの特性により、類似した気圧配置は近接して配置される。これにより、気圧配置の連続的な変化を視覚的に把握することが可能となる。

### 5.2 クラスタ間の関係
図2に示すように、SOMで得られた各クラスタ間には、気象学的に意味のある関連性が観察される。

### 5.3 分類精度
表1に示す分類精度の結果：

| クラスタ数 | 出現回数 | 精度（%） |
|----------|---------|----------|
| 25       | 25      | 100.0    |
| 21       | 25      | 84.0     |
| 19       | 25      | 76.0     |
| 13       | 25      | 52.0     |
| 全体     | 100     | 78.0     |

最も出現頻度が高いクラスタ（クラスタ25）では100%の精度を達成している一方、出現頻度が低いクラスタ（クラスタ13）では52%の精度にとどまっている。全体としては78%の精度を示している。

## 6. 考察

### 6.1 SOMの有効性
SOMを用いることで、気圧配置パターンを効果的にクラスタリングできることが示された。特に、類似したパターンが近接して配置される特性により、気象パターンの連続的な変化を理解しやすくなる。

### 6.2 1kmメッシュデータの活用
図1に示すように、SOMで得られたクラスタごとに、1kmメッシュの詳細な気象データを分析することで、各気圧配置パターンに対応する詳細な気象特性を把握できる。

### 6.3 精度の考察
出現頻度が高いパターン（100%精度）と低いパターン（52%精度）で精度に大きな差が見られる。これは訓練データの偏りや、稀な気象パターンの分類の難しさを示唆している。

## 7. 結論

本研究では、SOMを用いた気圧配置のクラスタリング手法を提案し、1kmメッシュの高解像度気象データを用いた分析を実施した。

主な成果：
1. 100個の気圧配置クラスタを効果的に生成
2. 類似パターンの視覚的な把握が可能
3. 1kmメッシュデータによる詳細な気象特性の分析
4. 全体で78%の分類精度を達成

今後の展望：
- より詳細な気象パターンの分析
- 予測精度の向上
- 実用的な気象予報への応用

## 8. 謝辞

本研究はJSPS科研費23KK0203の助成を受けている。

## 参考文献

[1] G. Vettigli, "Minisom: minimalistic and numpy-based implementation of the self organizing map," 2018. [Online]. Available: https://github.com/JustGlowing/minisom/

[2] 「気圧配置を対象とした事例ベース予報とSVMを用いた台風進路予測」Data Engineering and Information Management (DEIM 2009), vol. 2011, 2009

[3] R. N. Matsuoka, and M. Inatsu, "Weather classifications for high temperatures in japanese cities," SOLA, vol. advpub, pp. 2024–040, 2024.

[4] 気象庁「日本域データ同化システム（JRA-3Q）」, 2002

## 補足

本論文は、気圧配置パターンの分類と分析に機械学習手法（特にSOM）を適用した研究であり、高解像度の気象データ（1kmメッシュ）を活用することで、より詳細な気象現象の理解を目指している。SOMの自己組織化特性を活かし、気圧配置の連続的な変化を視覚的に表現できる点が特徴的である。
