# A Haar Wavelet-Based Perceptual Similarity Index for Image Quality Assessment（日本語訳）

原著タイトル: A Haar Wavelet-Based Perceptual Similarity Index for Image Quality Assessment  
著者: Rafael Reisenhofer（ラファエル・ライゼンホーファー）\*, Sebastian Bosse（セバスチャン・ボッセ）†, Gitta Kutyniok（ギッタ・クティニョク）‡, Thomas Wiegand（トーマス・ヴィーガンド）§  
掲載: Signal Processing: Image Communication, 2018 年 2 月  
DOI: 10.1016/j.image.2017.11.001  
備考: 一部の情報は ResearchGate ページ（https://www.researchgate.net/publication/305386157）に付随

注: 本文は PDF から抽出されたテキストを基にした正確な日本語訳です。図や数式画像のレイアウトは原著と異なる場合がありますが、数式・表現は文中に再現しています。

---

## アブストラクト（要旨）

実務の多くの場面で、画像・動画の圧縮や伝送は、最終的に人間の観察者に知覚される歪みを生み出す。逆に、インペインティングやデノイジングのような画像・動画復元技術は、人間の視聴者の体験品質（QoE）を高めることを目的とする。したがって、参照画像とその歪み画像の類似性を、人間の視聴者が主観的に体験する形で正しく評価することは、あらゆる伝送・圧縮・復元システムの改善に大きく寄与する。本論文は、Haar ウェーブレットに基づく知覚類似度指標（HaarPSI）を提案する。これはフルリファレンス（FR）の画像品質評価に向けた、新規で計算コストの低い類似度指標である。HaarPSI は、Haar ウェーブレット分解から得られる係数を用いて、2 つの画像間の局所的な類似性および画像領域の相対的重要性を評価する。HaarPSI の人間の体験品質（QoE）との整合性は、数千枚の異なる歪み画像を含む 4 つの大規模ベンチマークデータベース上で検証された。これらのデータベース上で、HaarPSI は、構造類似度（SSIM）、特徴類似度（FSIM）、視覚的顕著性に基づく指標（VSI）といった最先端の FR 類似度指標よりも高い相関を達成した。簡潔な計算構造と短い実行時間に加え、これらの実験結果は、HaarPSI の実環境タスクへの高い適用性を示唆する。

---

## 1. はじめに

デジタル画像・動画は日常生活で遍在しており、視覚データの重要性は増大し続けている。[1] によれば、2020 年までに毎秒ほぼ 100 万分の動画コンテンツがインターネットを経由すると見積もられている。

通常、動画・画像信号は最終的に人間により視聴されることを意図している。伝送や保存のため、ほとんどの信号は今日のチャネルやストレージ要求に対応するために圧縮される。圧縮や伝送エラーは、人間の視聴者に可視な歪みを画像や動画に導入しうる。伝送システムやその一部（例: 動画エンコーダのレート‐歪みのトレードオフ制御）を評価または最適化するためには、歪みの深刻さを知覚上意味のある形で測定することが決定的に重要である。「知覚的に意味のある方法」での品質は、心理測定テストによってのみ信頼性高く測定できる。こうしたテストでは、参加者が何らかの歪み処理が施された画像や動画の主観的品質を評価する。個々の参加者の品質評価は平均化され、各刺激に対する平均意見スコア（MOS）を得る。しかし、ゴールドスタンダードである一方で、これらの研究は高コストかつ時間がかかり、伝送システムの最適化や監視のようなリアルタイムタスクには全く適さない。このことは、計算的画像品質評価への研究を数十年にわたり動機づけてきた。

画像品質評価（IQA）手法は一般に、適用範囲と課題が異なる 3 つのカテゴリに分類される。フルリファレンス（FR）法は参照画像の利用を前提とし、参照画像の情報を活用する。縮約リファレンス（RR）法は、参照画像から抽出した小さな特徴集合を用いる。ノーリファレンス（NR）法は、単一画像のみから知覚品質を推定する [2]。拘束のない NR IQA は「聖杯」とみなされ、成功すれば人間の能力の再現に近づく。しかし、例えば動画圧縮のエンコーダ制御のような用途には適さない。NR 品質指標をレート‐歪み最適化に用いると、あらゆる種類のノイズやアーティファクトを取り除く方向に最適化を導く可能性があるが、ノイズやアーティファクトが意図的に付加される映像も存在する。例として、NR 指標が「ノイジー」な符号化決定を罰するために、クエンティン・タランティーノの映画「The Hateful Eight」からフィルムグレインを除去してしまうエンコーダを想像してほしい。これは映画製作者の意図した芸術的決定を変更し、視聴体験を損なうだろう。

最も単純な FR 画像品質指標は平均二乗誤差（MSE）で、参照画像と歪み画像の画素差の二乗平均で定義される。しかし、広く使われているにもかかわらず、知覚的品質と良い相関を示さないことが知られている [3]。知覚的に正確な IQA に向けたより洗練されたアプローチは、概して 3 つの戦略のいずれかに従う。ボトムアップアプローチは、人間視覚系（HVS）のさまざまな処理機構（マスキング効果 [4]、コントラスト感度 [5]、可知差域（JND） [6,7] など）を明示的にモデル化して知覚品質を評価する。例えば MAD（most apparent distortion）[8] は、歪みの大きさに対する HVS の適応性を明示的にモデル化し、閾上と閾近傍の歪みに異なる評価戦略を適用する。

一方、本論文で提案する手法を含む多くの最近の IQA 指標はトップダウンアプローチに従う。ここでは HVS をブラックボックスと見なし、その一般的な機能的性質を仮定して、知覚品質に対応する画像特徴を同定し活用する。代表例として、構造類似度（SSIM）[9]、視覚情報忠実度（VIF）[10]、勾配類似度（GSM）[11]、スペクトル残差に基づく類似度（SR-SIM）[12]、顕著性誘導指標（VSI）[13] などがある。SSIM [9] は、HVS が構造情報に対して感度を持つことを考慮し、輝度類似（局所平均輝度の比較）、コントラスト類似（局所分散の比較）、構造類似（参照画像と歪み画像の局所共分散）という 3 つの補完成分を統合する。批判もある [14] が、非常に多く引用され、最も普及した IQA 指標の一つである。SSIM はマルチスケールに一般化され、MS-SSIM [15] となった。情報理論に基づく FR IQA の初期の手法として VIF [10] がある。VIF はウェーブレット係数をガウススケール混合としてモデル化し、参照画像とテスト画像の間で共有される相互情報量を定量化し、これが知覚品質と相関することを示した。コントラストや構造の変化は [11] で局所勾配を考えることで捉え、輝度変動は画素値の二乗差を用いる。この枠組みは [9] で導入された補完的特徴マップの結合に従う。さらに [11] では、参照画像の局所勾配の大きさに基づいてマスキング効果を推定し、2 つの特徴マップを結合する際に取り入れる。SR-SIM [12] は局所的な水平・垂直勾配の大きさの変化を考慮し、加えてスペクトル残差に基づく視覚的顕著性の変化も取り込む。VSI [13] は SR-SIM に倣い、勾配大きさと視覚的顕著性の類似を組み合わせ、さらに顕著性マップを空間的プーリングの重み付けにも用いる。FSIM [16] では 2 つの特徴マップの組み合わせが成功裏に適用されており、提案法と概念的に類似しているため後ほど詳述する。

機械学習とデータサイエンスの進展を取り入れた第三の純粋なデータ駆動戦略も近年提案されている。データ駆動手法はこれまで主に NR IQA の領域で展開されてきた [17–20] が、FR IQA でも適用されている [21]。

### 1.1 貢献

本研究は、Haar ウェーブレットに基づく知覚類似度指標（HaarPSI）という新しい、計算コストの低い FR 画像品質評価指標を導入する。HaarPSI は、高周波の Haar ウェーブレット係数の大きさを用いて局所類似度を定義し、低周波の Haar ウェーブレット係数を用いて特定位置における（非）類似度の重要度を重み付ける。

HaarPSI の定義に用いる 2 次元 Haar ウェーブレットフィルタ 6 個は、異なる周波数スケールで水平・垂直のエッジに応答する。したがって HaarPSI は、一次視覚野のニューロンが示す機能的性質として知られる方位選択性と空間周波数選択性の基本的実装に基づく。我々は、これほど単純なモデルでも、人間の意見スコアと最先端レベルで相関する類似度指標を定義するのに十分であることを示すことを目指す。

HaarPSI は FSIM [16] の大幅な単純化としても見なせる。FSIM は、類似の類似マップと重みマップの組み合わせに基づくが、FSIM の定義では局所類似度と重みの両方が位相整合度（phase congruency）[22] に依存し、その計算には 16 個の複素値フィルタとの畳み込みや適応的なしきい値処理など複数の非自明なステップを要する。一方 HaarPSI では、2 つのマップはわずか 6 つの離散 Haar ウェーブレットフィルタの応答から計算され、局所類似度と重みが異なる周波数スケールに基づくという意味で明確に分離されている。驚くべきことに、これらの単純化は必要計算量を減らすだけでなく、人間の平均意見スコアとの相関を一貫して向上させる。

3 節では、HaarPSI の人間の体験品質との整合性を評価し、SSIM [9]、FSIM [16]、VSI [13] といった最先端の類似度指標と性能を比較する。表 1 および表 2 に示すように、HaarPSI は、VSI が唯一上回る 1 つのケースを除き、他のすべての FR 指標よりも高い相関を達成する。さらに、HaarPSI は、人間の意見スコアとの相関が 2 番目・3 番目に高い VSI と FSIM よりも有意に高速に計算できる。再現可能な研究を促進するため、Matlab 実装を http://www.haarpsi.org/ で公開している。

Haar フィルタは最も単純で計算効率の高いウェーブレットフィルタであり、その応答に基づく HaarPSI が有望な実験結果を示すのは都合が良く、また驚くべきことである。他のウェーブレットフィルタの適用可能性の数値解析の結果は表 4 に示す。

### 1.2 Feature Similarity Index（FSIM）

2011 年に提案された FSIM [16] は、現在最も成功し影響力のある FR IQA の一つである。FSIM は、位相整合度 [22] と参照画像・歪み画像の局所勾配から導かれる 2 つの特徴マップを結合して、2 つの画像の局所的な類似性を評価する。グレースケール画像 f ∈ ℓ²(Z²) に対して、勾配マップは次式で定義される：
G_f[x] = sqrt(((g_hor ∗ f)[x])² + ((g_ver ∗ f)[x])²), (1)  
ここで g_hor, g_ver は水平・垂直の勾配フィルタ（Sobel や Scharr など）であり、∗ は 2 次元畳み込みを表す。

FSIM の実装で用いられる位相整合度マップは Peter Kovesi による [23]。いくつかの非自明な処理（適応的ソフトしきい値など）を含むが、本質的には、グレースケール画像 f の位相整合度は
PC_f[x] ≈ |∑_n (g^c_n ∗ f)[x]| / ∑_n |(g^c_n ∗ f)[x]|, (2)  
で与えられる。ここで g^c_n はスケールと方位が異なる複素ウェーブレットフィルタ。位置 x で複素ウェーブレット係数が同位相なら、絶対値を取った和は絶対値の和に近く（あるいは等しく）、PC_f[x] は 1 に近づく。

2 つの画像に対し (1), (2) によるマップで局所類似度を評価するため、FSIM は [9] でも用いられたスカラー値の類似度測度
S(a,b,C) = (2ab + C)/(a² + b² + C), (3)  
（C > 0）を使用する。

2 つのグレースケール画像 f₁, f₂ ∈ ℓ²(Z²) に対する局所特徴類似度マップは
FS*{f₁,f₂}[x] = S(G*{f₁}[x], G*{f₂}[x], C₁)^β · S(PC*{f₁}[x], PC*{f₂}[x], C₂)^γ, (4)  
（C₁, C₂ > 0, β, γ > 0）。HVS がフーリエ成分の位相が整合する構造に特に敏感であるという仮定（例 [24]）に基づき、位相整合度マップは (4) の類似度の一部であると同時に、画像領域の相対的重要性を決める重みとしても用いられる。最終的な FSIM は局所特徴類似度の重み付き平均：
FSIM*{f₁,f₂} = (∑*x FS*{f₁,f₂}[x] · PC*{f₁,f₂}[x]) / (∑_x PC*{f₁,f₂}[x]), (5)  
ここで PC*{f₁,f₂}[x] = max(PC*{f₁}[x], PC\_{f₂}[x])。 (6)

元論文では、YIQ 色空間で定義されたカラー画像への拡張 FSIMC も提案している。Y は輝度、I と Q は色度である。RGB から YIQ への変換は線形写像で行える：
[f_Y, f_I, f_Q]^T ≈ [[0.299, 0.587, 0.114],
[0.596, -0.274, -0.322],
[0.211, -0.523, 0.312]] · [f_R, f_G, f_B]^T. (7)  
FSIMC では I, Q を (4) の局所特徴類似度に組み込む。勾配マップと位相整合度マップは Y（輝度）のみから導かれる。

---

## 2. Haar ウェーブレットに基づく知覚類似度指標

HaarPSI の基本アイデアは、(1) の精神で特徴マップを構築し、(2) に類似する重み関数を単一のウェーブレットフィルタバンクから得ることである。高周波ウェーブレットフィルタの応答は Sobel のような勾配フィルタの応答に似る。一方、FSIM で重みとして使う位相整合度は、多段の複素ウェーブレットフィルタバンクの出力から直接計算される（式 (2)）。したがって、単一の離散ウェーブレットフィルタ集合の応答から、FSIM に少なくとも匹敵し、かつ計算量が大幅に少ない類似度指標を定義できる直観が得られる。

本研究で選んだウェーブレットは、1910 年に Alfred Haar により提案された Haar ウェーブレット [25] で、最も単純で計算効率の高いウェーブレットといえる。1 次元 Haar フィルタは
h¹ᴰ₁ = (1/√2)·[1, 1], g¹ᴰ₁ = (1/√2)·[-1, 1], (8)  
であり、h¹ᴰ₁ はローパスのスケーリングフィルタ、g¹ᴰ₁ は対応するハイパスのウェーブレットフィルタである。任意のスケール j ∈ N に対し、
g^{(1)}_j = g¹ᴰ_j ⊗ h¹ᴰ_j, g^{(2)}\_j = h¹ᴰ_j ⊗ g¹ᴰ_j,  
と 2 次元 Haar フィルタを構成する（⊗ は外積）。j > 1 では
g¹ᴰ_j = h¹ᴰ₁ ∗ (g¹ᴰ_{j-1})↑2, h¹ᴰ*j = h¹ᴰ₁ ∗ (h¹ᴰ*{j-1})↑2,  
（↑2 は二倍ダイアディックアップサンプリング、∗ は 1 次元畳み込み）。g^{(1)}\_j は水平構造に、g^{(2)}\_j は垂直構造に応答する。本研究で用いる 6 つの Haar フィルタは図 1a（本文参照）に示す。

局所類似度マップ FS*{f₁,f₂} は、勾配ベースと位相整合度ベースの類似を重み β, γ > 0 で乗算的に結合する。しかし HaarPSI は異なる種類の類似を混在させない。人間の知覚類似を正しく予測するには、高周波 Haar ウェーブレットフィルタの応答から得られる局所類似に非線形写像を適用することが有用な場合がある。ここではロジスティック関数を採用する。これは生物学的ニューロンのしきい値挙動をモデル化する活性化関数として広く用いられ、α > 0 に対して
l*α(x) = 1 / (1 + e^{-αx}), (9)  
で定義される。

2 つのグレースケール画像 f₁, f₂ ∈ ℓ²(Z²) に対し、HaarPSI の局所類似度測度は 2 段の 2 次元離散 Haar ウェーブレット変換に基づき、
HS^{(k)}*{f₁,f₂}[x] = l*α( (1/2) · ∑*{j=1}^2 S( |(g^{(k)}\_j ∗ f₁)[x]|, |(g^{(k)}\_j ∗ f₂)[x]|, C ) ), (10)  
で与えられる。ここで C > 0, k ∈ {1,2} は水平・垂直フィルタを選ぶ指標、S は (3)、∗ は 2 次元畳み込み。HS^{(k)} は FS*{f₁,f₂} のアナログに見なせるが、HaarPSI では勾配や位相整合度のような異概念を混在させず、2 つの高周波 Haar フィルタの応答から素直に計算する。HS^{(k)} の可視化例は図 2 に示す。

FSIM の位相整合度 PC_f に類似して、HaarPSI でも重みマップを考えるが、これは単一の低周波 Haar フィルタの応答から導く：
W^{(k)}\_f[x] = |(g^{(k)}\_3 ∗ f)[x]|, (11)  
k ∈ {1,2}。図 2 に自然画像から計算した重みマップ W^{(k)} の例を示す。

2 つのグレースケール画像 f₁, f₂ に対し、HaarPSI は局所類似度 HS^{(k)} の重み付き平均を用いて最終スコアを与える：
HaarPSI*{f₁,f₂} = ( l^{-1}*α( (∑*x ∑*{k=1}^2 HS^{(k)}_{f₁,f₂}[x] · W^{(k)}_{f₁,f₂}[x]) / (∑*x ∑*{k=1}^2 W^{(k)}_{f₁,f₂}[x]) ) )², (12)  
ここで
W^{(k)}_{f₁,f₂}[x] = max( W^{(k)}_{f₁}[x], W^{(k)}_{f₂}[x] ), (13)  
k ∈ {1,2}。l^{-1}*α(·) は重み付き平均を [1/2, l*α(1)] から [0,1] に写像する。さらに (·)² により単位区間内で HaarPSI のダイナミクスを広げ、HaarPSI と人間の意見スコアの関係を線形化する。この処理はロジスティックの単調性ゆえに、3 節で報告する順位相関（SROCC）を改善も悪化もしない。

FSIM と同様、HaarPSI を YIQ 色空間のカラー画像に拡張できる。色度 I, Q に基づく第 3 の局所類似マップ HS^{(3)}*{f₁,f₂} を考える。これは f¹_I と f²_I、f¹_Q と f²_Q の比較から得る類似の平均を (10) と同様に l*α に通して定義する。HS^{(1)}, HS^{(2)} と異なり、HS^{(3)} は方位選択フィルタに基づかない。対応する重み W^{(3)}_{f^Y_1,f^Y_2} は W^{(1)}_{f^Y*1,f^Y_2} と W^{(2)}*{f^Y*1,f^Y_2} の平均とする。形式的には、
HaarPSIC*{f₁,f₂} = ( l^{-1}_α( (∑_x ∑_{k=1}^3 HS^{(k)}_{f₁,f₂}[x] · W^{(k)}_{f^Y*1,f^Y_2}[x]) / (∑_x ∑*{k=1}^3 W^{(k)}_{f^Y_1,f^Y_2}[x]) ) )², (14)  
HS^{(3)}_{f₁,f₂}[x] = l*α( (1/2)·( S(|(m ∗ f¹_I)[x]|, |(m ∗ f²_I)[x]|, C) + S(|(m ∗ f¹_Q)[x]|, |(m ∗ f²_Q)[x]|, C) ) ), (15)  
m は 2×2 の平均フィルタ、
W^{(3)}*{f^Y*1,f^Y_2}[x] = (1/2)·( W^{(1)}*{f^Y*1,f^Y_2}[x] + W^{(2)}*{f^Y_1,f^Y_2}[x] ). (16)

図 2 では、(a) 参照画像 f₁、(b) JPEG 圧縮で歪ませた f₂、(c) 水平局所類似 HS^{(1)}、(d) 垂直局所類似 HS^{(2)}、(e) 正規化した水平重み W^{(1)}、(f) 正規化した垂直重み W^{(2)} を示す。

### 2.1 パラメータ選択

HaarPSI と HaarPSIC は 2 つのパラメータ C と α の選択のみを必要とする。両パラメータは 4 つの大規模公開データベースのランダム部分集合上で最適化した。各サブセットは元データベースの 1/4 のサイズである。各データベース（3 節で詳述）は、多数の異なる歪み画像と対応する MOS を含む。C と α は、TID 2008 [26]、TID 2013 [27]、LIVE [28]、CSIQ [8] データベースのサブセットに対して、HaarPSIC と MOS のスピアマン順位相関（SROCC）4 つの平均を最大化するように選択した。最適化は 2 段階。まず C ∈ [5, 100]、α ∈ [2, 8] のグリッドサーチ。次に得られた (C, α) を Nelder–Mead 法の初期値として精緻化した。C は最寄りの整数、α は最寄りの 0.1 に丸め、C = 30、α = 4.2 を得た。一般性の検証として、TID 2008 & TID 2013 のみ、LIVE & CSIQ のみで同様の最適化を繰り返した。図 3 に結果を示す。

---

## 3. 実験結果

HaarPSI の人間の知覚品質との整合性を評価し、1 節で議論した多くの指標と比較した。評価には、品質注釈付き画像の 4 つの大規模公開ベンチマークデータベースを用いた。これらのデータベースは、参照画像数、歪みの種類・強度、観察者数、視聴条件の制御水準、提示手続きがそれぞれ異なる。

LIVE データベース [28] は 29 枚の参照カラー画像と 779 枚の歪み画像を含み、JPEG、JPEG2000、加法性白色ガウス雑音、ガウスぼかし、さらにレイリー・フェージングチャネルを通した JPEG2000 の伝送エラーが含まれる。各歪みは 5〜6 段階で導入され、平均約 23 名が参照と比較して品質を評価した。視距離などの視聴条件はある程度制御され、ダブルスティミュラスで評価を収集した。

TID 2008 [26] は 25 枚の参照カラー画像と 1700 枚の劣化画像を含み、多様な歪み（各種ノイズ、ぼかし、JPEG/JPEG2000 圧縮、伝送エラー、局所歪み、輝度・コントラスト変化など）を網羅する。主観評価は比較方式で収集され、3 つのラボとインターネットで異なる視聴条件の結果を平均した。後に TID 2013 [27] として拡張され、主に色度に関する新たな歪みが追加された。総計 3000 枚の歪み画像を含む。

CSIQ [8] は 30 枚の参照カラー画像に対し 866 枚の歪み画像を含む。6 種類の歪み（JPEG、JPEG2000、グローバルコントラスト低下、加法性ピンクガウス雑音、ガウスぼかし）を 4〜5 段階で導入。視距離は制御され、観察者は 1 つの参照画像に対する複数の歪み画像を、知覚品質に従って並べるよう求められた。

多くの計算的類似度指標の主目的は、異なるデータベースや歪み種類を越えて MOS と単調な関係を持つことにある。公正な比較のため、通常は順位相関や非線形回帰後の相関で比較する。本研究では、HaarPSI の評価全般において、MOS と各指標の相関を SROCC で測った。Kendall の τ や、4 パラメータのロジスティック回帰後のピアソン相関係数も検討し、ここで報告する結果を本質的に複製した。対応する表（SROCC 以外）は http://www.haarpsi.org/ に掲載。

また ITU の品質予測モデル評価ガイドライン [29] に従い、ここで報告する結果の統計的有意性も検定した。H₀（HaarPSI の相関と有意に異ならない）が p < 0.05 で棄却できる相関係数に色付けを行っている（表 1, 表 3, 表 4）。[30] に従い、z 変換の分散は 1.06/(N-3)（N は自由度＝サンプル数）で近似した。

表 1 は、LIVE、TID 2008、TID 2013、CSIQ における各 IQA 指標と MOS の SROCC を示す（グレースケール・カラー両方）。FSIM と HaarPSI はグレースケール・カラー双方に定義されるが、VSI はカラー専用である。他の指標はグレースケールのみ、または内部で RGB→ グレースケール変換して用いる。公正を期すため、全法をカラー画像と rgb2gray によるグレースケール画像の両方で評価した。VSI についてはグレースケール対を RGB に複製して評価した。

表 2 は、4 データベースにおける平均 SROCC と平均実行時間（ミリ秒）を示す。実行時間は Intel Core i7-4790（3.60GHz）で、ランダムな 512×512 画像対に対し各指標を 10 回ずつ計測。実装は各著者の公開実装を使用。グレースケール専用の指標はカラー評価時に変換コスト分やや遅くなる可能性がある。

アプリケーションによっては、データベース全体での高相関より、単一の歪みクラス内での高相関が重要な場合がある（例: 圧縮やデノイジング）。表 3 は、歪み種類ごとに限定したサブセット内での SROCC を示す。

単一相関係数は指標比較に有用だが、ピアソンなら線形性、SROCC なら単調性など、関係の特定側面のみを測る。関係をより直感的に可視化するため、図 4 は 4 データベースの DMOS と HaarPSIC の散布図を、歪み種類別に示す。

なお、本節の結果はすべて、HaarPSI や他の指標（SSIM, FSIM, VSI など）において、各画像に 2×2 の平均フィルタを畳み込み、ダイアディックなダウンサンプリングを施す前処理を行っている。これは HVS の光学系のローパス特性 [31] を単純モデルで近似するためである。

（表 1・表 2・表 3 の数値は本文テキストに含まれており、省略せず反映）

- 表 1（抜粋・SROCC）:

  - グレースケール（LIVE/TID2008/TID2013/CSIQ）において HaarPSI は 0.9690/0.9043/0.8094/0.9546。
  - カラーでは 0.9683/0.9097/0.8732/0.9604。
  - 多くの場合で HaarPSI は他指標を上回るか同等で、TID2013 カラーでは VSI が上回るケースあり。

- 表 2（平均 SROCC と時間）:

  - カラー平均 SROCC: HaarPSI 0.9279（240ms）、VSI 0.9223（790ms）、FSIM 0.9076（1420ms）。
  - グレースケール平均 SROCC: HaarPSI 0.9093（10ms）など。HaarPSI は高速かつ高相関。

- 表 3（歪み別 SROCC）:
  - LIVE の jpg, jpg2k, gwn, gblur, ff をはじめ、TID2008/2013 の多様な歪み群、CSIQ の各歪みに対する詳細な SROCC を列挙。HaarPSI は JPEG/JP2K 系や多くの歪みで最上位または競合するが、ガウスぼかしなど一部サブセットで VSI 等に劣る場面がある。

### 考察

HaarPSI は非常に単純な方位・空間周波数選択の計算モデルでありながら、人間意見スコアとの相関が高いことは特筆に値する。さらに、パラメータ C と α に対して広範囲で安定である（図 3）。これは、HaarPSI の計算構造が、人間視覚系の少なくとも一部の機能的本質を再現している可能性を示唆する。ただし、ベンチマークデータベースの限界（限られた参照画像と特定の歪みタイプ）も影響している可能性がある。実際、一次視覚野の方位選択は水平・垂直に限定されるものではない。

最近、知覚類似度で成功している計算原理として分割正規化（divisive normalization）[32] がある。S(a,b,C) はある種の正規化を導入するが、HaarPSI の各計算段には分割正規化は含まれていない。これを取り入れることで HaarPSI がさらに改善されるかは今後の課題である。

実用上、画像類似度の値は解釈しやすいことが望ましい。理想的には類似度 0.9 が平均的な人間の 90%の類似と対応し、0.8 は 0.9 より 10%劣ると直感できること。しかしこの課題は一般的に難しく、多くの指標は MOS と単調関係を目指す。HaarPSI では l^{-1}\_α(·)² の適用により MOS との関係が強く線形化され、図 4 の散布図が示すように、追加の非線形回帰なしでも高い線形相関を示す。付録 A の表 5 は、SROCC の代わりにピアソン相関を用いた評価であり、HaarPSI が強い線形関係を持つことを示している。

HaarPSI は FSIM の簡素版と概念的に捉えられる。どちらも、参照画像と歪み画像の局所類似マップと、画像領域の重要性を測る重みマップの 2 つを構築する。ただし HaarPSI は単一の Haar フィルタバンクのみからこれらを定義するのに対し、FSIM は 16 個の複素フィルタによる位相整合度の実装を用い、適応的しきい値など非自明なステップを含む。さらに FSIM は位相整合度を (4) の局所類似と (5) の重みの双方に用いるが、HaarPSI では (10) の局所類似と (11) の重みは周波数帯域の異なる情報に基づき厳密に分離される。

この単純化は実行時間の大幅短縮（表 2）につながり、最終スコアに対する各要素や入力画像の性質の寄与をより良く理解させる。HaarPSI では局所類似は高周波情報、重みは低周波に同調したフィルタで得られる粗い顕著性の尺度に基づく。我々は、FSIM においても類似の原理が働いていると推測するが、FSIM の低周波同調フィルタは位相整合度の計算に暗黙的に組み込まれ、局所類似と重みの双方に関与するため、明確な検証が難しい。

HaarPSI が FSIM を相関で上回る理由は自明ではない（表 1）。両者は全体構造が類似し、方位・空間周波数選択といった類似原理を実装する。推測として、HaarPSI の低複雑性は、パラメータ C と α を変えた際に入力の異なる側面を強調しても、制御不能な副作用を抑制する可能性がある。これはデータベースのサブセットに対して 2 つの自由パラメータのみで良好にフィットできる一方、汎化誤差を減少させる可能性がある。さらに、HaarPSI の方位選択の実装は、水平・垂直の情報を最後の重み付き平均で初めて結合する点で異なる。一次視覚野で似た方位に同調するニューロンが方位コラムとしてグループ化されることはよく知られている [33]。したがって、垂直・水平フィルタの情報を一貫して分離することは、人間意見スコアとの相関に良い影響を与え得る。

計算の観点では、他のウェーブレットより離散 Haar を用いる利点は大きい。ただし (8) の h¹ᴰ₁, g¹ᴰ₁ を別のウェーブレットフィルタに置換すれば、(12) の計算は容易に他ウェーブレットに一般化できる。表 4 は、Daubechies、symlet、coiflet、Cohen–Daubechies–Feauveau（CDF）などのウェーブレットに基づく指標の SROCC を示す。Haar は計算効率が高いのみならず、質的にも最良の選択であることが示唆される。

（表 4 の数値を本文テキストどおり反映）

- グレースケール（LIVE/TID2008/TID2013/CSIQ）:
  - HaarPSI: 0.9690/0.9043/0.8094/0.9546
  - Daub2PSI: 0.9620/0.8971/0.8064/0.9492 など
- カラー（同様に列挙、HaarPSI が概して最上位または同等）

Matlab 実装は http://www.haarpsi.org/ からダウンロード可能。

---

## 4. 結論

HaarPSI は、離散 Haar ウェーブレット変換の 3 段の係数のみに基づく、新規で計算コストの低い画像品質指標である。その妥当性は 5000 枚超の異なる歪み画像を含む 4 つの大規模データベースで検証され、有望な結果を示した。9 つの代表的最先端指標との比較で、HaarPSI はグレースケールで有意に高い、あるいは統計的に区別できないスピアマン相関を達成した。カラーでは TID 2013 に限り VSI に次ぐ 2 位となる（表 1）。簡潔な計算構造と比較的短い実行時間は、HaarPSI の実環境最適化タスクへの高い適用性を示す。特に、PSNR、SSIM、SR-SIM のように HaarPSI より高速でも、人間意見スコアとの相関はかなり劣る（表 2）。特定の最適化課題に関しては、HaarPSI は JPEG/JPEG2000 による歪みに対して一貫して高い相関を示す（表 3）。

表 1 と表 3 の結果は一見矛盾するように見える。HaarPSI はデータベース全体では最高の SROCC を示すことが多いが、単一歪みに限定すると VSI などに劣ることがある。しかし統計的有意性を考慮すると、TID のガウスぼかしに限定した場合のみ、HaarPSI の性能は一貫して他指標より低い。これは、HaarPSI がほぼ専ら高周波情報に依拠するため、低域フィルタリングに基づく歪みに対して過敏であることに起因すると考えられる。

単一の歪み種類に限れば、HaarPSI の C と α を調整することで相関を改善できる可能性がある。C を増やすと、高周波類似 HS^{(1,2)} に対する低周波重み W^{(1,2)} の相対的重要性が増し、HaarPSI の高周波変化への感度が低下する。α → 0 でも類似の効果がある。図 3 に見られる C と α のほぼ負の線形関係はこの説明と整合する。一方、α を大きくすると l_α(·) はしきい関数の挙動に近づき、高周波成分の重大な変化のみに敏感になる。図 5 は TID2013 の各歪みに対する C と α の影響を示し、例えばガウスぼかしでは C を増やし α を 0 に近づけることで性能向上が示唆される。JPEG 圧縮では、高い顕著性位置で高周波の重大変化に敏感となる設定が高相関をもたらす。

---

## 謝辞

R. Reisenhofer は NYU 視覚計算ラボの Eero Simoncelli、Johannes Ballé とメンバーに感謝する。S. Bosse と G. Kutyniok は Anthony Norcia に感謝する。G. Kutyniok は Eero Simoncelli に感謝し、Einstein Foundation Berlin、ECMath、欧州委員会プロジェクト DEDALE（契約 665044、H2020）、DFG Grants （KU 1446/18, SPP 1798: KU 1446/21, KU 1446/23）、DFG SFB TRR 109、DFG Research Center Matheon の支援に謝意を表する。

---

## 参考文献

[1] Cisco. Cisco visual networking index: Forecast and methodology, 2015-2020. Whitepaper, 2016.  
[2] W. Lin, C.-C. J. Kuo. Perceptual visual quality metrics: A survey. JVCIR, 22(4):297–312, 2011.  
[3] B. Girod. What’s wrong with mean-squared error? In Digital Images and Human Vision, 1993.  
[4] A.B. Watson et al. Image quality and entropy masking. SPIE Proc., 3016, 1997.  
[5] S. J. Daly. Noise-adaptive CSF to image compression. Optical Engineering, 29(8), 1990.  
[6] J. Lubin. HVS model for objective picture quality. IBC, 1997.  
[7] Y. Jia et al. Estimating JND for video. IEEE TCSVT, 16(7), 2006.  
[8] E. C. Larson, D. M. Chandler. MAD: FR IQA and strategy. J. Electronic Imaging, 19(1), 2010.  
[9] Z. Wang et al. SSIM. IEEE TIP, 13(4):600–612, 2004.  
[10] H. R. Sheikh, A. C. Bovik. VIF. IEEE TIP, 15:430–444, 2006.  
[11] A. Liu et al. GSM. IEEE TIP, 21(4):1500–1512, 2012.  
[12] L. Zhang, H. Li. SR-SIM. ICIP 2012.  
[13] L. Zhang et al. VSI. IEEE TIP, 23(10):4270–4281, 2014.  
[14] R. Dosselmann, X. D. Yang. SSIM assessment. SIVP, 5(1):81–91, 2011.  
[15] Z. Wang et al. MS-SSIM. Asilomar Conf., 2003.  
[16] L. Zhang et al. FSIM. IEEE TIP, 20(8):2378–2386, 2011.  
[17] L. Kang et al. CNN for NR IQA. CVPR 2014.  
[18] P. Ye, D. Doermann. Visual codebooks for NR IQA. IEEE TIP, 21(7), 2012.  
[19] P. Zhang et al. SOM for IQA. CVPR 2015.  
[20] S. Bosse et al. DNN for IQA. ICIP 2016.  
[21] S. Bosse et al. FR IQA using NN. QoMEX 2016.  
[22] P. Kovesi. Phase congruency. Psychological Research, 64:136–148, 2000.  
[23] P. D. Kovesi. Matlab/Octave functions: http://www.csse.uwa.edu.au/~pk/research/matlabfns/  
[24] M. C. Morrone et al. Mach bands phase dependence. Nature, 324, 1986.  
[25] A. Haar. Orthogonal function systems. Math. Ann., 69(3), 1910.  
[26] N. Ponomarenko et al. TID2008. Advances of Modern Radioelectronics, 10, 2009.  
[27] N. Ponomarenko et al. TID2013. SP: Image Communication, 30:57–77, 2015.  
[28] H. R. Sheikh et al. LIVE release 2. http://live.ece.utexas.edu/research/quality  
[29] ITU-T P.1401, 2012.  
[30] E. C. Fieller et al. Tests for rank correlation. Biometrika, 44(3/4), 1957.  
[31] S. E. Palmer. Vision science. MIT Press, 1999.  
[32] V. Laparra et al. Perceptually optimized rendering. arXiv:1701.06641, 2017.  
[33] D. H. Hubel, T. N. Wiesel. Orientation columns. J. Comp. Neurology, 158(3), 1974.  
[34] I. Daubechies. Orthonormal wavelets. CPAM, 41(7), 1988.  
[35] I. Daubechies. Ten Lectures on Wavelets. SIAM, 1992.  
[36] I. Daubechies. Orthonormal wavelets II. SIAM J. Math. Anal., 24(2), 1993.  
[37] A. Cohen et al. Biorthogonal wavelets. CPAM, 45(5), 1992.

---

## 付録 A ピアソン相関（抜粋）

表 5 は、非線形回帰なしで MOS と各指標のピアソン相関を示す。HaarPSI は LIVE/TID2008/TID2013/CSIQ において 0.9592/0.9032/0.8904/0.9463（カラー）など強い線形相関を示す。歪み別の詳細も本文に列挙の通りで、JPEG/JP2K 系や多くの歪みで高い線形相関を達成している一方、特定サブセットで他指標が優位な場合もある。

（数値は本文に記載の値を忠実に反映）
