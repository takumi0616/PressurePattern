タイトル: 変形可能畳み込みニューラルネットワークと全球時空間気候データによる大規模循環レジームの予測

書誌情報:

- 掲載誌: Scientific Reports (2022) 12:8395
- DOI: https://doi.org/10.1038/s41598-022-12167-8
- 出版社ページ: https://www.nature.com/scientificreports
- オープンアクセス: 本論文は Creative Commons Attribution 4.0 International（CC BY 4.0）ライセンスの下で公開

著者:

- Andreas Holm Nielsen (1,2)\*
- Alexandros Iosifidis (1)
- Henrik Karstoft (1)
  (1) Department of Electrical and Computer Engineering, Aarhus University, Aarhus, Denmark
  (2) Danske Commodities A/S, Aarhus, Denmark

* 連絡先: ahn@ece.au.dk

概要:
大気の状態を有限個の大規模循環レジームに分類することは、テレコネクション、激甚気象の予測可能性、気候変動を調べるうえで一般的な方法である。本研究では、変形可能畳み込みニューラルネットワーク（deformable CNN; deCNN）と転移学習に基づく教師あり機械学習アプローチを用いて、拡張した北半球冬季における北大西洋‐ヨーロッパ（NAE）地域の天候レジームを、1〜15 日先まで予測する。機械学習分野の最先端の解釈手法を適用し、任意の天候クラスタ予測やレジーム遷移に関連する関心領域や潜在的なテレコネクションを帰属（アトリビューション）する。提案法は、いくつかの古典的な気象ベンチマークに加え、ロジスティック回帰やランダムフォレストと比較して優れた予測性能を示す。視野の広さ（field of view）の違いにより、deCNN はリードタイム 5〜6 日以降で、通常の CNN よりも大幅に良い性能を発揮することも観察された。さらに、先行研究のデータ駆動型大気予測と同様に、転移学習が極めて重要であることが確認された。

序論:
力学気象学の文献では、大気の状態を有限個の天候レジーム（大規模循環パターン）で表現することが一般的であり、これはテレコネクションの調査、数値予報（NWP）モデルの予測スキルの分析、気候変動の定量化などに有用である。例えば NAE 域では、大規模循環レジームの正確な予測能力は、2009/2010 年冬の北・西ヨーロッパにおける寒波の連鎖などの極端な気温偏差の予測可能性と直接結びついている。複雑な気候相互作用のため、複数の研究は我々の気候過程理解が不十分であることを示唆しており、レジームやテレコネクションの予測スキルの向上は、全球気候システム理解の改善や 2 週間限界を超える予測可能性の増加に資する。

機械学習、とりわけ深層学習は、明示的な専門的定式化に頼らず高次元データからパターンを学習できるため、天気予報、対流のパラメタリゼーション、熱帯低気圧や総観スケール前線の検出などで顕著な成功を収めている。天候レジーム・気候・テレコネクションの同定と予測に深層学習を用いる関心も高まりつつあるが、既存のデータ駆動研究は、(a) NWP モデルが正確とされる 5 日先程度に限られるか、(b) 全球データとテレコネクションを十分に取り込めないことが多い。さらに、正則化回帰などのデータ駆動法は成功しているものの、確率的手法ほど情報量の多い出力は得られない。

こうした背景から、本研究は、日から数週に及ぶ中期スケール（1〜15 日）の時間地平で、全球天候データを用いた確率的データ駆動法による大規模循環レジーム予測を検討する。これは主要レジームが天候変動の主因であり、かつ全球 NWP のスキルが低下しやすい時間帯でもあるため重要である。

データと方法:
目的達成には大量の（望ましくはラベル付きの）データが必要となる。本研究では、経験直交関数（EOF）と k-means による NAE 天候レジームのラベリングを行い、4 つの確立されたレジーム（NAO+、NAO−、スカンジナビアブロッキング（SB）、アトランティックリッジ（AR））を得る。入力変数としては、Z50/200/500/700 hPa のジオポテンシャル高度偏差、海面水温（SST）偏差、海面更正気圧（MSLP）偏差を用いる。転移学習によって 2 つの再解析データセットの系統差に対処し、過学習を抑制しスキルを向上する。大規模データで事前学習したモデルを小規模データで微調整する。

データの説明と前処理:

- 大規模データ: NOAA-CIRES-DOE Twentieth Century Reanalysis v3（20CRv3）。1836〜1980 年のサンプルを使用。解像度は赤道で約 75 km、鉛直 64 層、80 メンバ。1981〜2015 年も利用可能だが、後述の小規模データと重複するため割愛。
- 転移先データ: ERA5（1981〜2018 年）。

転移学習のため、両データで経度 5.625 度格子（WeatherBench に合わせ 32×64 グリッド）へ双一次補間で再格子化する。30 年移動気候値（5 年ごと更新）を用いて偏差を作成し、季節周期や自己相関の影響を部分的に除く。20CRv3 は 21,931 サンプル、ERA5 は 6,050 サンプル（拡張冬季: 11/15〜3/31）。再格子化で欠損・破損のある少数日を除外。

NAE レジームのラベリング:
500 hPa ジオポテンシャル高度偏差（Z500）を、90°W–30°E, 20°–80°N の領域で計算し、EOF により 14 次元空間（全分散の約 90%）に射影、k-means で 4 クラスタ（最適個数とされる）を抽出。各観測は 14 次元空間で最も近いセントロイドへ割り当て、NAO+（32%）、SB（28%）、NAO−（19%）、AR（21%）のラベルとする。クラス不均衡が学習に悪影響となり得るため、学習時に重み付き損失等で対処する。

変形可能畳み込みニューラルネットワーク（deCNN）:
CNN は固定幾何変換に制約されるが、deCNN は学習可能なオフセットにより変換不変な特徴をより広域・高局所化で学習できる。全球格子データでテレコネクションを直接取り込む本課題に適する。モデルは deCNN 層、バッチ正規化、Leaky ReLU、ドロップアウト、2×2 の最大プーリング（ストライド 1; 入力の空間次元を 1/2 に）、全結合 2 層（間にドロップアウトと Leaky ReLU）で構成。deCNN では特徴マップを生成するカーネルとオフセットを同時学習する。

学習の詳細:
時空間データの学習・検証・テスト分割は重要で、分割戦略は結論を左右し得る。本研究では、ENSO、PDO、AMO の位相に基づく層化抽出で学習・検証を構築。テストは ERA5 の 2011〜2018 年（将来データ一般化、海洋メモリの影響回避）。1854〜2018 年の AMO、1856〜2018 年の PDO、1871〜2018 年の ENSO を収集。1837〜1870 年は全テレコネクションが揃わないため学習に使用。20CRv3 期間（1870–1979）と ERA5（テスト除く 1979–2011）で位相分布を求め、20%を検証、80%を学習に層化サンプリング。サンプルの重複回避のため各フォールドは少なくとも 1 年分を含む。

損失はクラス不均衡に対処する重み付き交差エントロピー（重みは最多クラスに対する各クラス比）。最適化は Adam。早期終了で過学習抑制。ハイパーパラメータはベイズ最適化（BO）で各リードタイムごとに最適化（フィルタ数、ドロップアウト率、全結合層のユニット数、バッチサイズ）。学習率は LR range test で選択。学習時間は GPU（RTX 2080-RTI×2）でリードタイムごとに事前学習込み約 30 分、並列化可能。

性能評価:
確率的およびカテゴリカルな複数指標で 1〜15 日リードタイムを評価。

- AUC-ROC（多クラスは各クラスの AUC を真例数で重み付け）
- クリティカル成功指数（CSI）: CSI = TP / (TP + FN + FP)
- ブライアスコア（BS）: BS = (1/N) Σ_t (f_t − y_t)^2
- 多クラス精度（ACC）
  また、deCNN の ROC 曲線と Performance Diagram も提示。Performance Diagram は検出率、誤警報率、バイアス、CSI をまとめて示す。

ベンチマーク:

- ロジスティック回帰（LR）、ランダムフォレスト（RF）。入力は Z500 の EOF 20 成分（直交で 90%以上の分散を説明）。生データ入力の試行では性能が 5–10%低下。
- 持続（Persistence）予報: 初期時刻 t0 のレジームを将来へ継続。
- 週間気候値（Climatology）: 学習集合における各週の優勢レジームをテスト集合に適用。
  これらは気象分野で最低限のスキル基準として一般的。

結果:
予測結果:
表 1 にすべてのモデルの性能を要約。deCNN は 5、10、15 日で最高精度。特に 10 日、15 日では CNN との差が拡大し、長リードでの広視野の重要性を示す。主目的は確率的に全レジームを均等に良く予測することであり、AUC-ROC を主指標とする（持続・気候は確率でないため非該当）。15 日では、CNN と RF の ACC 差は 0.08 だが AUC-ROC 差は 0.23 など、重み付き交差エントロピーの影響で ACC と AUC のトレードオフが見られる。持続・週間気候は強いベースラインであり、LR/RF は全リードでこれらに近く、15 日では週間気候に劣る場合もある。

転移学習の重要性:
ERA5 のみで学習した deCNN（no pretrain）は、転移ありと比べて著しく低性能。5 日で AUC-ROC が 0.533→0.459、15 日で 0.352→0.257 へ低下。先行研究同様、転移学習は成功に不可欠。

図 1（ACC と AUC-ROC のリードタイム曲線）では、長リードで deCNN が抜きん出る。ACC は長リードで週間気候に収束する傾向。

10 日先の deCNN の各クラスの ROC と Performance Diagram（図 2）では、全クラスの ROC が対角より上にあり、特に NAO− のスキルが高い。一方 SB は難しい。AR は NWP に比べ良好。

表 1（抜粋; Days=リード日数, x=確率出力なしで未算出）:

- Persistence: ACC 0.470（5 日）, 0.344（10 日）, 0.317（15 日）
- Weekly climatology: ACC 約 0.325 前後
- LR/RF/CNN/deCNN: deCNN が AUC-ROC/CSI/BS で優位、特に長リードで顕著
- deCNN（no pretrain）は一貫して劣後

解釈結果:
本研究では、深層学習の最先端解釈手法である Integrated Gradients（IG）を用いる。IG は、基準入力 x′（一般にゼロ画像）から実入力 x への直線経路上の勾配の経路積分に、(x − x′)を掛けて特徴寄与を得る。
IntegratedGrads(x) = (x − x′) × ∫\_{α=0}^{1} ∂F(x′ + α(x − x′)) / ∂x dα

IG はノイズに弱いことが多く、SmoothGrad（SG）によりノイズ除去を行う。さらに寄与の二乗平均（SG-SQ）が SG より改善するとされるため、本研究では SG-SQ を採用。

代表的な遷移の IG を検討し、モデルの頑健性と信頼性を高める。SB→NAO−、NAO+持続、NAO+→AR に注目し、主に Z500 の寄与を可視化。転移なし deCNN との比較も行う。

ケース 1: SB → NAO−
11 日リードで約 30%の頻度。deCNN は 32.5%の確率で正しく予測。スペイン・ポルトガル西方の負偏差クラスター、スカンジナビアからアイスランドへ伸びる正偏差、米国東海岸の正偏差など、NAO− 特有あるいは物理的に妥当な領域が強調される。一方、転移なし deCNN では解釈が難しく、フランス周辺を強調するなど特異性に乏しい領域が顕在化し、局所テレコネクションの強調が弱い。

ケース 2: NAO+ の持続
11 日先まで約 37.7%。deCNN は 39.1%で正しく予測。北大西洋北部の負偏差、欧州中部から大西洋に伸びる正偏差など、NAO+の識別的パターンを強調。一方、大西洋中央部の正偏差は AR と重なるため差別化に使われず強調されない。転移なし deCNN ではこの領域が強調されるなど、転移学習の重要性が示唆される。

ケース 3: NAO+ → AR
11 日先で約 23.8%とやや稀。deCNN は本例で NAO+→SB を 26.4%で予測（文献上は NAO+→SB の方が生起しやすい）。東カナダの負偏差、ノルウェー海の正偏差など、NAO+に関連するパターンが強調されるが、寄与は疎で不確実性が高いことを示唆。転移なし deCNN では多くの領域（アフリカ南方洋上など）を強調し、関連領域の同定に失敗している可能性。

考察:
本研究は、NAE 域の大規模循環レジームを 1〜15 日先で予測するため、deCNN に基づく教師あり学習戦略を導入した。deCNN は広い視野と局所化能力により、広域にまたがる変換不変な空間パターンを学習でき、CNN、LR、RF、持続、週間気候に対し優れた性能を示した。特に 5〜6 日を超えるリードで有効性が高い。レジーム別では、NAO− が最も予測容易、SB が最も困難で、NWP の傾向と一致。一方 AR が NAO+より良好な場合があり、NWP と差異も見られた。

解釈の観点では、IG によりグリッド点単位で寄与を定量化し、レジームや遷移の識別に関係する特徴を可視化。deCNN（転移あり）は識別的特徴を強調する一方、転移なしは広域かつ非識別的領域を強調する傾向が見られた。転移学習は精度向上に有益だが、もし新規テレコネクションの発見など科学的発見が主目的なら、転移による局所化の強化が探索性と相反する場合があり、バランスが必要となる。

将来展望として、通年の NAE レジームや準季節スケール（低スキル帯）への拡張、Büeler ら（2021）との比較、IG 等の解釈法の限界への対処として複数手法の併用などが有望である。解釈を主出力として新規テレコネクションの発見を目指すことも、全球気候力学の理解に資する可能性がある。

データ利用可能性:

- 20CRv3: https://psl.noaa.gov/data/gridded/data.20thC_ReanV3.html
- ERA5: Copernicus Climate Data Store https://cds.climate.copernicus.eu/
- ENSO: https://psl.noaa.gov/people/cathy.smith/best/
- PDO: https://www.ncdc.noaa.gov/teleconnections/pdo/
- AMO: https://psl.noaa.gov/data/timeseries/AMO/

謝辞:
Danske Commodities A/S の Axel Wagner、Kim Bentzen、Morten Hygum に感謝する。本研究は Danske Commodities A/S の資金提供を受けた。

著者貢献:
A.N.が実験を構想・実施、A.I.と H.K.が研究を監督。全著者が原稿を査読。

利益相反:
なし。

追加情報:

- 連絡先: A.H.N.
- 刷り直し・許諾: www.nature.com/reprints
- 出版社注: Springer Nature は地図や所属に関する法的主張に中立。

ライセンス:
本記事は CC BY 4.0 で配布され、原著者と出典への適切なクレジット、ライセンスへのリンク、改変の明示を条件に、媒体や形式を問わず使用・共有・改変・頒布・再配布が許可される。記事中の画像や第三者素材についてクレジット表示がある場合はその表示に従う。ライセンス全文: http://creativecommons.org/licenses/by/4.0/

参考文献:
本文中に示された文献番号および出典は原論文の通り。（例：Michelangeli et al. 1995; Cassou 2008; Rasp et al. 2020; Dai et al. 2017; ほか多数）
