タイトル: 深層学習による北京–天津–河北地域の強雨に対応する循環パターンの識別（FConvNeXt）

書誌情報:
- 掲載誌: Atmosphere 2023, 14, 930
- DOI: https://doi.org/10.3390/atmos14060930
- 受理: 2023-05-23 / 公開: 2023-05-25
- ライセンス: CC BY 4.0（https://creativecommons.org/licenses/by/4.0/）

著者・所属:
- Linguo Jing（成都信息工程大学 計算機科学学院）
- Qi Zhong（中国気象局 訓練センター, 責任著者: zhongq@cma.gov.cn, +86-010-68409215）
- Xiaojie Li（成都信息工程大学 計算機科学学院）
- Xiuming Wang（中国気象局 訓練センター）
- Lili Shen（河北省気象災害防御与生態気象センター）
- Yong Cao（国家気象センター）

キーワード:
- 短時間強雨（強雨）
- 循環パターン
- 客観分類
- 深層学習
- 北京–天津–河北（BTH）地域

要旨（日本語訳）:
降水の性質・分布は特定の総観パターンにより規定されるため、対応する影響パターンの客観的識別は短時間強雨の予報改善に不可欠である。しかし強雨は局地・突発・激甚で、影響系が中規模以下で不完全にしか現れないことが多く、識別が難しい。本研究は特徴クロスフュージョン（Cross-Fusion）モジュールを組み込んだ深層学習ネットワークFConvNeXtを提案し、BTH地域の強雨に対応する4主要循環型（弱い総観強制型WSF、低渦型LVT、亜熱帯高気圧縁辺型SPT、上層トラフ型UTP）を対象にした。FConvNeXtはConvNeXtやResNetより良好な性能を示し、とくにWSF, SPT, LVTの識別精度が高い。2021年の独立検証でも性能を維持し（SPTは減少）、UTPの識別が最も低いこと、限定領域での北東渦の切り取りにより浅いUTPとの混同が生じやすいことを示した。本研究は強雨の客観的高解像度予報の改善に資する。

1. 序論
- BTH地域は華北の農業・都市・政治中枢で、短時間強雨による洪水・都市水害の影響が大きい。
- 強雨は局地的・突発的で、影響系（中規模以下）が限定領域内では不完全表示になることが多く、主観分類や従来客観法（クラスタリング、EOF等）の識別精度が低い。
- 先行研究: 主観分類は準拠基準の非一貫性・客観性不足、クラスタリングはメソスケール系の不完全表示に弱い。ResNet/ConvNeXt等の深層学習は高精度だが、限定領域での弱特徴抽出が課題。
- 目的: 500 hPa高度の限定領域画像を入力とし、ConvNeXtにクロスフュージョン特徴抽出を加えたFConvNeXtを開発、弱い・不完全なパターンを高精度に分類する。

2. データ・領域
- 循環場: ERA5 500 hPaジオポテンシャル高度（0.25°）、期間2013/5/1–2021/9/30。学習対象領域は112–122°E, 35–45°N（図1の赤枠）。参考として広域の100–130°E, 20–55°N図も用意（主観分類例の理解用）。
- 降水: 自動気象観測所データによる強雨日判定、2021年の描画には融合降水CMPA（雨量計・レーダQPE・CMORPH衛星の３源融合）を使用。
- 強雨日の定義（Zhong 2022準拠の概略）:
  1) しきい値20 mm/hで日内の強雨発生回数を各局で集計、局数合算。
  2) 日合算が75%超、または50 mm/h超の強度＋同時に局数が50%超の場合、その日を強雨日と定義。

3. 主観的循環型の定義（4型）
- WSF（弱い総観強制）: 500 hPaに有意な系がなく、限定領域では顕著な循環シグナルがない（図2a, 図3a）。
- LVT（低渦）: 中下層の低渦（BTHでは北東渦が支配的）。限定領域では南側の曲率部分のみが見えることが多い（図2b→図3b）。
- SPT（亜熱帯高気圧縁辺）: 30°N以北で東アジア中高緯度の場は直線的で、南東隅にわずかな循環（図2c→図3c）。
- UTP（上層トラフ）: 上層トラフまたは浅いトラフに伴う寒気侵入が誘因（図2d→図3d）。
- 2013–2020の主観分類サンプル: 計316日（WSF=100, LVT=89, SPT=72, UTP=55）。限定領域ではLVTの北東渦が切り出されUTPの浅いトラフと混同しやすい。

4. 手法
4.1 比較モデル
- ResNet-50: 残差接続で深層学習の勾配消失を軽減する基盤モデル。
- ConvNeXt: ResNetを最適化し、特徴抽出を強化した畳み込み骨格（近年の標準的CNNバックボーン）。
- FConvNeXt（本研究）: ConvNeXt-S骨格＋クロスフュージョン特徴抽出モジュールを付加し、弱特徴・局所特徴の強化を図る。

4.2 FConvNeXt概要
- 入力: 500 hPa高度の3チャネル画像（224×224×3）。※高度画像をRGB化（スケール一律化）。
- ConvNeXt部: 5段のステージ（パッチ化→ConvNeXtブロック群×{3,3,9,3}、中間次元{96,192,384,768}）。
- クロスフュージョン部（図4下）:
  - 並列3経路（Conv, Conv, MaxPool+Conv）で初期特徴F1,F2,F3（112×112×768）を抽出。
  - F1+F2, F1+F3, F2+F3をそれぞれConv処理して値域差を補正（弱特徴の増幅・整合）。
  - 3特徴を融合しF7を得る→MaxPool/LayerNorm/ReLU/Convを2段通過してF8（7×7×768）に圧縮。
  - ConvNeXt最終特徴v5とF8を加算→GAP/LayerNorm/FC→1000次元出力。
- 活性化: ConvNeXtブロックはGELU、クロスフュージョンはReLUを使用。
- 正規化: LayerNormを適用。
- ダウンサンプリング: LN→Conv(k=2, s=2)。
- ドロップパス: ConvNeXtブロック内部で過学習抑制。

4.3 実験設定
- データ分割（2スキーム）:
  1) 2013–2020の5–9月を6:4でランダム分割し学習/評価。
  2) 学習は2013–2020（上記の通り）、2021年（5–9月）を厳密独立テストとして汎化性能を検証（タイムリーク回避）。
- 画像前処理: 限定領域の500 hPa高度を画像化、弱特徴抽出を助けるため値域を100分の1にスケーリング。
- ハイパーパラメータ（FConvNeXt最適）: epoch=50, batch=12, lr初期=5e-4, 最終=1e-5（他モデルも同条件）。

4.4 評価指標
- クラス別分類精度（各主観型に対して正しく推定できた割合）
- ACC（Accuracy）= (TP+TN)/(TP+TN+FP+FN)
- RMSE: 合成循環パターン画像の誤差（km）。小さいほど良い。
- 主観分類を真値として比較。

5. 結果（2013–2020ランダム分割のテスト）
5.1 クラス別精度（Table 1要約）
- ResNet-50: WSF 37.5%, LVT 40%, SPT 28.5%, UTP 13.6%
- ConvNeXt: WSF 62.5%, LVT 25.7%, SPT 64.3%, UTP 14%
- FConvNeXt: WSF 62.5%, LVT 40%, SPT 61%, UTP 14%
→ FConvNeXtはWSF/SPTでConvNeXt同等以上、LVTで+14.3ptの改善。UTPは3法いずれも低い。

5.2 ACC（Table 2–4要約）
- WSF ACC: FConvNeXt 64.8% > ConvNeXt 57.6% > ResNet 58.4%
- LVT ACC: ConvNeXt 76% > FConvNeXt 73.6% > ResNet 66.4%
- SPT ACC: FConvNeXt 79.2% ≈ ConvNeXt 80.0% > ResNet 70.4%
- UTP ACC: FConvNeXt 77.6% > ConvNeXt 76.0% > ResNet 74.4%
- 総ACC: FConvNeXt 73.8% > ConvNeXt 72.4% > ResNet 67.4%

5.3 RMSE（Table 5）
- WSF: ResNet 0.08（最小）, ConvNeXt 0.13, FConvNeXt 0.15
- LVT: FConvNeXt 0.15（最小）
- SPT: FConvNeXt 0.14（最小）
- UTP: ConvNeXt 0.12（最小）
→ FConvNeXtはLVT/SPTで最小、総合的に優位。WSFはResNetが最小だがACC/再現性は劣る。

5.4 ランダム分割の安定性（Table 6）
- 3回のランダム分割でSPT精度は61–64%と安定。WSF/LVT/UTPは最大差11.5%だがグループ1・3は類似。
- 分割に対して結果は概ねロバスト。

5.5 合成循環図の比較（図8 vs 図3）
- WSF: 等高度線は平滑で顕著系なし（整合）。
- LVT: 北部に明瞭な渦度・曲率（整合）。
- SPT: 南東部に反時計回りの循環（整合）。
- UTP: 北東部に浅いトラフ（整合）。ただし限定領域ではLVTの部分曲率と形状が近く混同の要因。

6. 2021年の独立検証
6.1 サンプル分布の変化（図9）
- 2013–2020平均に比べ2021年はWSFが減、LVTが顕著増、SPTがやや減、UTPは同程度。

6.2 クラス別精度（図10）
- WSF 66.6%、LVT 41%、SPT 29%、UTP 14%
- LVTとUTPの混同が目立ち、SPTは系が東方・場が平坦な日が多くWSFへ誤分類（4例）。

6.3 ACC・RMSE（Table 7–8）
- ACC合計=66.68%。WSF ACC=57.8%、LVT=53.3%、SPT=75.6%、UTP=80.0%。
- RMSE: LVT=0.102（最小）, UTP=0.248, WSF=0.343, SPT=0.307。
→ UTPはACCは高い一方、クラス再現は低く、LVTと形状が似ている影響が示唆。

6.4 降水分布（図13 vs 図14）
- 2021主観（図13）: WSFは分散的、LVTは山前帯（500 m等高線下の山前平野）に集中、SPTは亜熱帯高気圧縁辺＋西側地形帯、UTPは京津平原〜河北中南部山前。
- FConvNeXt（図14）: LVTの降水再現が最良（位置整合、やや弱い）。WSFはSPT誤分類（4例）の影響で南西山地に偏差。UTPはLVT混同により差異が大きい。
→ 全体として循環・降水の空間特徴は概ね整合し、クロスフュージョンが有効。

7. 考察・結論
- 提案FConvNeXtは限定領域の弱特徴（不完全表示の低渦、浅いトラフ、WSF）をConvNeXtより高精度に抽出し、2013–2020・2021の双方で良好な汎化性能を示した。
- 依然としてUTPとLVTの混同が残る。北東渦の一部切り取り（限定視野）により浅いトラフ形状と近似することが主因。空間拡張（広域コンテキスト）やマルチレベル入力（200 hPa, 850 hPa等の併用）で改善の余地。
- 実務的示唆: 深層学習分類により主観判断のばらつきを低減し、タイプ別の高解像度降水・ナウキャストの補強に活用可能。とくにWSFや弱系の客観識別に寄与。
- 今後: 入力変数の多層化（上層ジェット/下層風）、広域＋限定領域の二重入力、時系列（3D/ConvLSTM）導入、注意機構の活用等で精度向上が見込める。

資金:
- NSFC 41875058, 41505079; 国家重点R&D 2021YFC3000903; CMA Innovation（CXFZ2023J001）; CMA天気復盤（FPZJ2023-170）; CMATC重点研究（2022CMATCZD13）。

著者貢献:
- 原稿: L.J., Q.Z.; 資源: X.L.; 概念設計: X.W.; 監督: L.S.; ソフト: Y.C.

利益相反:
- なし

略語:
- WSF: 弱い総観強制（Weak Synoptic Forcing）
- LVT: 低渦（Low Vortex）
- SPT: 亜熱帯高気圧縁辺（Subtropical-high Periphery）
- UTP: 上層トラフ（Upper-level Trough）
- TPT: 台風型（Typhoon Type, 本論文中では対象外）

参考文献（抜粋）:
- ERA5（Hersbach et al. 2018）、ConvNeXt（Liu et al. 2022）、ResNet（He et al. 2016）ほか、BTHの降水分類・主観/客観分類・クラスタリング関連の先行研究、CMPA製品の検証研究など。
