MONTHLY WEATHER REVIEW, May 2002, Vol.130, pp.1187–1206
© 2002 American Meteorological Society

再帰的分割（CART）と主成分分析（PCA）による総観図パターン分類
Synoptic Map-Pattern Classification Using Recursive Partitioning and Principal Component Analysis

著者:
- Alex J. Cannon, Paul H. Whitfield
  Meteorological Service of Canada—Science Division, Pacific and Yukon Region, Vancouver, BC, Canada
- Edward R. Lord
  Pacific Weather Centre, Meteorological Service of Canada—Pacific and Yukon Region, Vancouver, BC, Canada

原稿受理: 2000/12/05、最終版受理: 2001/08/24

要旨（Abstract）
総観規模の地図（海面気圧SLPや500 hPa高度場など）を離散群に分類する方法を提示する。木構造ベースの再帰的分割（CART）モデルを用い、総観循環場と、地上観測要素（気温、露点、雲量（雲光学的濁度）、風のu・v成分）の線形PCおよび非線形PC（NLPC）との間の写像を構築する。局地気象条件に結びつく指標をターゲットに用いることで、統計的には一意だが気候学的意義が乏しいパターンの抽出を回避する。本法は調整パラメータが少なく、保持すべきパターン数の決定に客観的指針（交差検証に基づく1-SEルール）を与えるアルゴリズムを含む。適用例として、ブリティッシュコロンビア州と北東太平洋を覆う領域のSLPと500 hPa高度の日平均（1953–1998）を用い、ターゲットの気象要素はバンクーバー（Vancouver, BC）の地上観測から得た。降水と大気質（オゾン）のシナリオで性能を比較し、k-meansクラスタリングに基づく非教師ありの地図パターン分類と比較した。その結果、線形PCをターゲットとした再帰的分割はk-meansを上回った。NLPCをターゲットにした木は線形PCターゲットよりわずかに劣った。入力として循環データの格子点（グリッド）値を用いた木は、循環データの（切り詰めた）PCを用いた木より良好であった。後者の劣化はPCの次元削減に伴う情報損失ではなく、PCAが情報を符号化する方法に起因している可能性が示唆された。

1. 序論（Introduction）
総観気候学は、大規模大気循環と局地スケールの地表環境との関係を扱う（Barry and Perry, 1973）。アプローチは大別して2つ（Yarnal, 1993）:
- 循環→環境（circulation-to-environment）: 総観図を分類/クラスタリングしてから局地環境とのリンクを探る。各パターンに対し期待される環境条件を計算・検証でき、予測的評価（観測-予測の統計）や比較が可能。
- 環境→循環（environment-to-circulation）: 環境変数の基準で循環データを構造化（例: 合成）。予測的な使い方はできない。

両者の中間に位置づけられる仕様（specification）や経験的ダウンスケーリング（Hewitson and Crane, 1994）は、総観循環と地表環境変数の関係を求める（Klein, 1983）。仕様は格子点とパラメータ選択が地表側に依存しつつも、総観情報のみから環境を予測可能な関係式を与える。一方、分類ベースの総観気候学は、連続関係ではなく離散的な地図パターンに循環を層別する利点がある。

自己組織化写像（SOFM）などの自動分類は、循環状態の連続体をよく捉えうるが（Cavazos 1999, 2000）、結果の解釈に再クラスタリングなどの追加処理を要し（Murtagh, 1995）、小さなクラス数では標準クラスタ手法に劣ることがある（Balakrishnan et al., 1994）。また、総観・局地のリンクを組み入れないため、気候学的意義の薄いパターンが混入しうる。

これに対し、手動分類は専門家が気象学的意義のあるクラスを保証できるが、労力と再現性が課題。Frakes and Yarnal (1997) は手動テンプレートと自動相関照合のハイブリッドを提案したが、テンプレート選定に専門家の負荷が残る。総観と地表データの両方を入力にして非教師ありでクラスタリングする案もあるが、将来日（例: GCM出力）の分類には局地観測が使えず適用性が限定される。

本研究では、仕様と分類の利点を統合する再帰的分割（CART; Breiman et al., 1984）を用いる。CARTは入力（総観格子点など）から出力（局地環境指標）への非線形・相互作用を含む規則木を学習し、出力に基づき循環を最も同質的に二分割していく。これにより、局地環境にとって意味のある循環パターンが優先的に選ばれる。既往のCART適用は降水など単一局地変数をターゲットとした例が多かった（Hughes et al., 1993; Zorita et al., 1995; Schnur and Lettenmaier, 1998; Zorita and von Storch, 1999）。

本研究の主目的は、複数の気象要素から1次元の指標（線形PCAおよび非線形PCA（NLPCA）による）を生成し、これをCARTのターゲットにする拡張で、地域の一般的な総観気候分類を構築することである。これにより、手動分類（Lamb, 1972; Hess and Brezowsky, 1977）や地域自動分類の代替となる、局地気象を反映した総観タイプが得られる。

2. データ（Data）
2a. 大気循環
NCEP–NCAR再解析（Kalnay et al., 1996）のSLPと500 hPa高度の日平均（1953–1998）を用いる。領域は西北米〜北太平洋（40°–62.5°N, 157.5°–110°W）。2.5°格子を空間平均で5°×5°に平滑化（図1の格子配置）。季節的な大きさの変動が分類を支配しないよう、各日の値から±6日を含む13日移動平均の中心値を差し引くフィルタを適用（Hewitson and Crane, 1992; Yarnal, 1993）。これにより13日より長いスケールの平均的振幅変動を除去しつつ、総観スケール変動を保持し、季節の巨視的特徴のみを反映するパターンを回避する。

2b. 地上気象要素
環境カナダの空港観測から、バンクーバー国際空港（図1）の1時間値として、気温、露点、雲の光学的不透明度（%）、風速、風向を用いる。日平均を算出し、風はu（東西）・v（南北）成分へ変換。循環データ同様に13日移動平均差で季節性を除去。

3. 方法（Method）
3a. 再帰的分割（CART）
CARTは入力→出力の関係を、ノードでの二分割規則の連なり（木）として表現する（図2）。出力が連続変数のとき、各分割は左右子ノードの残差平方和の減少（親ノードのSSから左右のSS合計を引いたSC = SS_T − (SS_L + SS_R)）が最大となるように、入力変数・閾値を探索する。分割候補の探索は全入力上で反復的に行う。

制御パラメータは、分割試行の最小ケース数 N_s と終端（葉）ノードの最小ケース数 N_t（既定で N_s=20, N_t=N_s/3）。過学習を避けるため、初期は大きく成長させた木を交差検証で剪定する。N分割交差検証により、枝刈り後の各サブツリーの汎化誤差を評価し、最小誤差＋1標準誤差（1-SE）以内で最小の木を選ぶのが標準（Therneau and Atkinson, 1997; 図3）。総観分類では1-SEが過大なクラス数を選ぶことも多く、実務的には少ないクラス数へ意図的に剪定し、性能の低下を交差検証誤差のプラトーで確認する。

3b. 線形/非線形主成分分析（PCA/NLPCA）
線形PCAは、多変量データの最適な直交座標を当てはめ、分散の大部分を少数のPCで表現する（Green, 1978）。NLPCA（Monahan, 2000）は5層ニューラルネットで非線形構造を抽出し、中間のボトルネック層のスコア（NLPC）で低次元表現を得る。気候分野ではNLPCAが線形PCAよりよい近似を与える事例が報告されている（Monahan et al., 2000, 2001）。

3c. CART×PCAによる地図パターン分類
入力: フィルタ済みのSLPおよび500 hPa高度の格子点値（McKendry, 1994に倣い同時利用）。CARTは相関構造に頑健かつ高次元入力を扱えるため、事前のPCAによる次元削減は必須ではない。比較のため、循環データを相関行列に基づくS-mode PCAでPCスコアへ圧縮し（SLPと500 hPaの寄与が等重みになるように実装）、Overland & Preisendorfer (1982) の rule-Nテストで11成分（全分散の93%）を保持した入力も用意した（循環側へのNLPCAの適用は不採用）。

出力（ターゲット）: 地上5要素のフィルタ済みデータから、相関行列に基づくP-mode線形PCAの第1主成分（PC1）と、NLPCAによる第1成分（NLPC1）の2種類を作成。NLPCAはMonahan (2001) に準拠しつつ、学習はresilient backpropagation（Riedmiller, 1994）を用いる。20ネットのアンサンブルから停止学習で正則化、最大5000反復、検証データは学習データの20%、エンコード/デコード層は各4ノード。候補間の正規化平均二乗距離が5%基準を超えない構成を採用。

CART構築: 既定の N_s=20, N_t=7 を用い、10分割交差検証の誤差曲線を用いて剪定しクラス数を決定。ベンチマークとして、循環PCスコアをk-means（最大ノルム初期化: Katsavounidis et al., 1994）でクラスタリングした分類と、格子点標準化データへ直接k-meansを適用した分類を作成した。

4. 結果（Results）
4a. 地上要素のPCとNLPC
表1に地上要素データの総分散に対するPC1およびNLPC1の寄与率（r^2）と、各要素の個別寄与率、PC1との相関符号を示す。PC1は総分散の42%（気温・露点>50%、雲不透明度~40%、風成分は各~25%）を説明。相関符号は、気温・露点・雲は正、uは負、vは正。NLPC1は総分散の58%を説明し、PC1比+16%の改善（vのみ2%低下）。

4b. クラス数の選択
CART（RPART）モデルについて、交差検証誤差曲線（図4上: RPART/grid/PC、下: RPART/C-PCA/NLPC）から1-SEルールを適用すると、線形PCターゲットでは53クラス（誤差0.585）と42クラス（0.691）、NLPCターゲットでは28クラス（0.656）と25クラス（0.757）が推奨された。しかし実用性を考慮し、4種のRPART系で最も小さい25クラスを採用した。25クラス選択による性能低下は、例えばRPART/grid/PCで1-SE推奨比+~3%未満の未説明分散増に留まる。

4c. 性能評価の方法
各分類器の性能は、日次の観測系列（地上要素・降水・夏季オゾン等）に対し、各クラスの学習期間平均値を予測値として割り当て、観測との一致度を10分割交差検証で評価（r^2を主指標、RMSEとWillmottの一致度も整合）。学習データ内の過大評価を避けるため、常に外部検証データでr^2を算出して平均。

4d. 地上要素に対する分類性能
図5に各地上要素のr^2（交差検証平均、レンジは誤差バー）を示す。CARTはPCをターゲットにしているため、k-meansより優位が期待され、実際に格子点入力のCART（RPART/grid/PC, RPART/grid/NLPC）が全要素でk-means（grid/C-PCA）を上回った。循環PC入力のCART（RPART/C-PCA/PC, /NLPC）はk-meansより優位な要素もあるが、風成分ではk-means/gridが勝る場合があった。

入力の違いでは、格子点入力が循環PC入力を一貫して上回った（CARTでもk-meansでも同様傾向）。CARTではgrid/PC平均21% vs C-PCA/PC平均15%、grid/NLPC平均20% vs C-PCA/NLPC平均13%。PC切り詰めの情報損失が原因か検証するため、循環PCの全成分を入力とするCARTも構築したが、性能は切り詰め時と同等（~15%）で格子点入力（~22%）に劣った。したがって、PC表現そのもの（空間的に分散した荷重に基づく分割）が、局地の識別に不利に働く可能性が高い。

ターゲットの違いでは、線形PCターゲットの方がNLPCターゲットよりわずかに良い（平均でCART/grid: +1%、CART/C-PCA: +2%）。NLPCAの圧縮利得が、そのままCARTの分類性能向上に直結しないことが示唆される。

4e. 降水シナリオの性能
1953–1998のバンクーバー空港の日降水を対象に層別。図6より、CART/grid/PCが最良（r^2=22%）、CART/grid/NLPC=18%。k-means/grid=14%、循環PC系（RPART/C-PCA/PC=12%、/NLPC=11%、k-means/C-PCA=13%）を上回った。格子点入力の優位は交差検証の変動幅を超える顕著な差。

4f. 大気質（オゾン）シナリオの性能
ロッキーポイントパーク（Vancouver東方）の日最大オゾン（1991–1996年5–9月、830日）を対象に、11クラスで評価（図7）。サンプル数減でばらつきは増えるが、平均的にはCART/grid/PCが最良（r^2=21%）、CART/grid/NLPC=18%、CART/C-PCA/{PC,NLPC}=15%、k-means {grid=11%, C-PCA=8%}。クラス別の分布（図8）から、52 ppb超の80日のうち33日がクラス1（図9左）で、下層の温暖トラフ＋上層リッジ（Taylor, 1991; McKendry, 1994）と整合。最低オゾンはクラス8（右、上層トラフ＋沖合高気圧）に対応。

4g. CART分類の解釈
CARTの木（例: 図10のRPART/grid/PC、25クラス）では、各分割ノードにSLP（S）または500 hPa（H）の格子点IDが表示され、縦間隔は誤差減少量に比例。各葉に予測PC値、割当ケース数、クラス番号（予測PCの降順）が示される。葉ごとにSLP/500 hPaの合成偏差図（図11）を作成。木の右枝（図11a）はPC正（気温・露点・雲↑、u↓、v↑）、左枝（図11b）はPC負（気温・露点・雲↓、u↑、v↓）に対応。

代表例としてクラス1–3（右枝）と23–25（左枝）を概説し、季節別のクラス頻度と地上要素の合成値（生値/13日偏差）を表2に示す。右枝（S1格子北のSLP正偏差）では、500 hPaは北西北米に強いリッジ、東太平洋にトラフ。1→3でリッジ–トラフの振幅は減少し位置が南東へ移動。上層は南西流で暖湿気の輸送、前線群はBC北岸〜アラスカに進み、バンクーバーは温暖域で雲多く温暖湿潤、地上圧力傾度はSEが卓越し強風化（前線直前）。左枝（SLP負偏差側）は、太平洋東部のリッジとBC/PNW/グレートプレーンズの低圧・トラフの組合せで、上層はNW〜NE（場合によりS）流。冬季は後面場となり、BC内陸に溜まった寒冷乾燥の大気が山谷風として流出、バンクーバーは東〜北東風で寒冷・乾燥・晴天が多い。

降水の箱ひげ（図12）では、右枝に多雨、左枝に少雨が明確に分離。冬・春・秋は前線通過型（クラス1,2）が最多雨、夏はクラス4（クラス1に類似だが弱い負偏差）が上位分位点の降水に対応。最小降水は後面場（クラス24,25）。

5. 論議と結論（Discussion and Conclusions）
- CART×PCAにより、局地気象要素の指標に条件づけられた総観パターン分類が自動で得られ、純粋な非教師あり分類より局地気象との結びつきが強い。全シナリオで最良のCARTが最良のk-meansを上回った。
- CARTは木と予測PC値により、パターンの秩序立った構造化と重要分割の解釈を容易にする。交差検証誤差曲線はクラス数選択の客観的指針（1-SEルールやプラトーの評価）を与える。ただし大規模用途では1-SE推奨が過大になることがあり、平滑化曲線の屈曲点解析など、より適した自動基準の開発が望まれる。
- 本法の有効性は、出力指標（地上要素の1D表現）と対象変数の結びつきに依存する。PC/NLPCいずれでも情報圧縮に伴う情報損失は避けられず（本データではPC1=42%）、NLPCは圧縮能は高いがCART性能は線形PCが僅差で優位であった。天気型（エアマス）クラスタをターゲットにしたCARTや、多変量応答のCART（地上要素の多次元を直接ターゲット）など代替も有望で、後者は情報損失を回避できる可能性がある（現在検討中）。
- 入力表現では、循環PC入力より格子点入力が優位。これはPC切り詰めの情報損失の問題ではなく、PCが広域の線形結合として情報を空間的に分散させるため、局地の識別に有効な「近傍の格子点」に基づく分割が行われにくいことが原因と考えられる。将来は適用目的に応じて格子点/PCのいずれかを選択すべきである。

謝辞
査読者の建設的な助言に感謝する。

参考文献（原文のまま）
Anderberg, M. R., 1973: Cluster Analysis for Applications. Academic Press, 359 pp.
Balakrishnan, P. V., M. C. Cooper, V. S. Jacob, and P. A. Lewis, 1994: A study of the classification capabilities of neural networks using unsupervised learning: A comparison with k-means clustering. Psychometrika, 59, 509–525.
Barry, R. G., and A. H. Perry, 1973: Synoptic Climatology: Methods and Applications. Methuen, 555 pp.
Breiman, L., J. H. Friedman, R. A. Ohlsen, and J. C. Stone, 1984: Classification and Regression Trees. Wadsworth and Brooks, 358 pp.
Brinkmann, W. A. R., 1999: Application of non-hierarchically clustered circulation components to surface weather conditions: Lake Superior basin winter temperatures. Theor. Appl. Climatol., 63, 41–56.
Burrows, W. R., 1991: Objective guidance for 0–24-hour and 24–48-hour mesoscale forecasts of lake-effect snow using CART. Wea. Forecasting, 6, 357–378.
——, 1997: CART regression models for predicting UV radiation at the ground in the presence of cloud and other environmental factors. J. Appl. Meteor., 36, 531–544.
——, M. Benjamin, S. Beauchamp, E. R. Lord, D. McCollor, and B. Thomson, 1995: CART decision-tree statistical analysis and prediction of summer season maximum surface ozone for the Vancouver, Montreal, and Atlantic regions of Canada. J. Appl. Meteor., 34, 1848–1862.
Cannon, A. J., and E. R. Lord, 2000: Forecasting summertime surface-level ozone concentrations... J. Air Waste Manage. Assoc., 50, 322–339.
——, and P. H. Whitfield, 2001: Modeling transient pH depressions... J. Amer. Water Resour. Assoc., 37, 73–89.
Carter, M. M., and J. B. Elsner, 1997: A statistical method for forecasting rainfall over Puerto Rico. Wea. Forecasting, 12, 515–525.
Cavazos, T., 1999; 2000: ... J. Climate, 12, 1506–1523; 13, 1718–1732.
Faucher, M., W. R. Burrows, and L. Pandolfo, 1999: ... Climate Res., 11, 173–190.
Frakes, B., and B. Yarnal, 1997: ... Int. J. Climatol., 17, 1381–1396.
Green, P. E., 1978: Analyzing Multivariate Data. Dryden Press, 519 pp.
Greene, J. S., L. S. Kalkstein, H. Ye, and K. Smoyer, 1999: ... Theor. Appl. Climatol., 62, 163–174.
Hess, P., and H. Brezowsky, 1977: Katalog der Grosswetterlagen Europas (1881–1976)...
Hewitson, B. C., and R. G. Crane, 1992; 1994: ... J. Climate, 5, 1002–1011; Neural Nets..., Kluwer.
Hughes, J. P., D. P. Lettenmaier, and P. Guttorp, 1993: ... Water Resour. Res., 29, 3303–3315.
Kalkstein, L. S., M. C. Nichols, and C. D. Barthel, 1996: ... Int. J. Climatol., 16, 983–1004.
Kalnay, E., et al., 1996: The NCEP/NCAR 40-Year Reanalysis Project. Bull. Amer. Meteor. Soc., 77, 437–471.
Katsavounidis, I., C. C. J. Kuo, and Z. Zhang, 1994: ... IEEE Signal Process. Lett., 1, 144–146.
Klein, W. H., 1983: ... Mon. Wea. Rev., 111, 277–290.
Lamb, H. H., 1972: ... Geophysical Memoirs, No. 116, HMSO.
Maunder, W. J., 1968: ... Northwest Sci., 42, 80–88.
McGregor, G. R., and D. Bamzelis, 1995: ... Theor. Appl. Climatol., 51, 223–236.
McKendry, I. G., 1994; McKendry et al., 1995: ... J. Appl. Meteor., 33, 627–641; Atmos.–Ocean, 33, 809–825.
Monahan, A. H., 2000; 2001; Monahan et al., 2000; 2001: ... J. Climate, 13, 821–835; 14, 219–233; GRL, 27, 1139–1142; 28, 1019–1022.
Muller, R. A., 1977: ... J. Appl. Meteor., 16, 20–33.
Murtagh, F., 1995: ... Pattern Recognition Lett., 16, 399–408.
Overland, J. E., and R. W. Preisendorfer, 1982: ... Mon. Wea. Rev., 110, 1–4.
Pryor, S. C., I. G. McKendry, and D. G. Steyn, 1995: ... J. Appl. Meteor., 34, 1824–1833.
Riedmiller, M., 1994: ... Comput. Stand. Interfaces, 16, 265–278.
Ryan, W. F., 1995: ... Atmos. Environ., 29, 2387–2398.
Schnur, R., and D. P. Lettenmaier, 1998: ... J. Hydrol., 212–213, 362–379.
Taylor, E., 1991: ... Tech. Rep. PAES-91-2, AES Pacific Region.
Therneau, T. M., 1983; Therneau and Atkinson, 1997: ... Stanford Univ.; Mayo Clinic Tech. Rep. 61.
Weiss, S., and C. Kulikowski, 1991: Computer Systems that Learn. Morgan Kaufmann.
Willmott, C. J., 1981: ... Phys. Geogr., 2, 184–194.
Yarnal, B., 1993: Synoptic Climatology in Environmental Analysis. Bellhaven Press.
Zorita, E., and H. von Storch, 1999; Zorita et al., 1995: ... J. Climate, 12, 2474–2489; 8, 1023–1042.
