タイトル: “Dunkelflaute（暗黒無風）”事象の自動識別：畳み込みニューラルネットワーク（CNN）ベースのオートエンコーダ手法

著者:
- Bowen Li (a)
- Sukanta Basu (a)
- Simon J. Watson (b)
所属:
a. Faculty of Civil Engineering and Geosciences, Delft University of Technology, Delft, Netherlands
b. Faculty of Aerospace Engineering, Delft University of Technology, Delft, Netherlands

原稿受理歴:
- 受理: 2022年2月11日
- 最終版: 2022年8月7日

掲載誌・DOI・権利:
- Artificial Intelligence for the Earth Systems（AIES）
- DOI: 10.1175/AIES-D-22-0015.1
- ©2022 American Meteorological Society（AMS）。再利用・著作権情報はAMS Copyright Policy（www.ametsoc.org/PUBSReuseLicenses）を参照

キーワード: 再生可能エネルギー；クラスタリング；深層学習

要旨（Abstract）:
欧州のエネルギーシステムにおける風力・太陽光の重要性が増すにつれ、「Dunkelflaute（長時間の無風・曇天）」のような不利な気象条件が系統運用に大きな課題をもたらす。そのため、再解析・数値天気予報・気候投影といったオープンデータから、こうした事象を正確に同定・特徴付けることが重要となる。本研究では、風速と日射の空間パターンを自動的に符号化し、そこからDunkelflaute期間を識別する二段階の教師なし深層学習フレームワーク（WISRnet: wind and solar network）を提案する。第1段階では、深い畳み込みニューラルネットワーク（CNN）ベースのオートエンコーダ（AE）により、二次元の空間パターンから特徴抽出を行う。得られるCNN-AEの二次元符号化パターンは、振幅と空間情報を簡潔に内包する。第2段階では、k-meansアルゴリズムの一種を用いて、これらCNN-AEパターンを地域依存の気象クラスタに分割する。検証として、ベルギーの集約風力・太陽光発電量データを用い、既往研究の単純基準に基づき6年分データからDunkelflaute期間を直接同定し、各期間をWISRnet由来のクラスタに対応付けた。その結果、Dunkelflaute期間の大半は25クラスタ中5つのクラスタのみに属することが分かった。専有の発電量データがなくとも、WISRnetは公開気象データからDunkelflaute期間を識別可能であることを示し、さらにデンマーク、スウェーデン、英国に展開して事象の識別・特徴付けを実証した。

1. 序論（Introduction）
風力・太陽光が欧州の電力システムで主要な供給源となるにつれ、発電に大きく影響する極端気象の同定・特徴付けが重要となる。Dunkelflaute（同時に低い風力・太陽光発電量となる事象）は、北欧諸国で冬季に複数日持続することがあり、需給バランスに課題をもたらす。そのため、Dunkelflauteの信頼できる識別・特徴付け、さらには予測の枠組みが必要である。
先行研究（Li et al. 2021a,b）は、メソスケールモデルの再現性評価や、北海・バルト海周辺諸国のDunkelflaute簡易気候学を示したが、識別には専有の発電量データを用いた。再生可能エネルギー産業は新しく、各国で長期の発電量データが十分に公開されていない。一方、再解析・数値予報・気候投影などの格子化気象データは長期・公開である。本研究は、これらオープンデータを取り込み、自動的にDunkelflauteを識別する機械学習（ML）手法を開発する。

2. 関連する機械学習アルゴリズムの概観
機械学習は、入力データから有用情報を自動抽出したりタスクを学習したりする枠組みで、教師ありと教師なしがある。本研究はラベルがないため教師なし手法を採用する。
大気科学では、k-means、階層クラスタリング、自己組織化マップ（SOM）などの教師なしクラスタリングが総観パターン分類や極端温度の傾向解析、予報支援、極端パターン同定、風力予測などで用いられてきた。一方、教師ありCNNは画像・動画など多次元データから表現的特徴を自動学習し、地球科学でも雲・氷晶・地表分類・火山変動などで高精度を示す。ただし多くの応用でラベルが得られないため、教師なしCNNの必要性がある。近年は自己教師あり学習も台頭している。
高次元特徴ベクトルのクラスタリングは、多様なノイズや非線形・非定常、マルチスケール性のため困難になりがちである。過学習や汎化低下を避けるため、ラベル不要で高次元入力から重要特徴を抽出するオートエンコーダ（AE）が有効である。大気科学でもCNN-AEによるパターン・極端のクラスタリングが報告されている。本研究は新しいCNN-AEで風速・日射の空間パターンを低次元に圧縮し（二次元の符号化パターン）、その後にk-meansでクラスタリングする。

図1: 2017年1月16日12UTCの（左）100 m風速、（右）下向き短波放射（日射）。この日はベルギーでDunkelflauteが発生し再エネ発電が大幅に不足した。

図2: 提案するWISRnetフレームワークの概念図。

3. データセットの説明
地上観測の風速・日射は疎で記録が短く、地形影響や測定誤差もあるため、本概念実証ではECMWF再解析ERA5（Hersbach et al. 2020）を用いる。ERA5は時間（毎時）・空間（約31 km）解像度が高く、Dunkelflaute研究でも有用性が示されている。
用いる変数は、地上から100 mの毎時風速、地表の下向き短波放射（日射）で、期間は2009–2018年（標本数86904）。領域は北海と隣接国（46.75°–62.5°N, 12°W–19.75°E；64×128格子）に焦点。図1は2017年1月16日のDunkelflaute例で、ベルギーの再エネ発電が大きく低下した。
検証にはベルギーの集約風力・太陽光発電量データ（Elia）を使用し、発電データの入手可能期間に合わせ2013–2018年を対象とする。15分値を毎時に集約し、Li et al. (2021a)の定義（風力・太陽光のそれぞれの設備利用率が20%を同時に下回る1時間）でDunkelflauteをラベル付けする。既報では1日超のDunkelflauteは主に拡張冬季（10–2月）に発生。

4. 方法論
a. WISRnetフレームワークの概要
図2に示す深層学習アーキテクチャにより、気象パターンをクラスタリングしDunkelflauteを識別する。風速と日射は別々にCNN-AEへ入力され、エンコーダ（7畳み込み層）が入力の特徴を符号化し、ボトルネック層として二次元パターンを出力する。一般に1次元全結合（FC）をボトルネックにする例が多いが、二次元の符号化パターンは地理座標上に容易に投影でき、空間的重み（例: 二次元ガウス核）との畳み込みが行いやすい。空間関係の把握に適するため本研究は2Dボトルネック層を採用する。
デコーダは二層のFCと五層の畳み込みで入力の再構成を行う（非対称AE）。FCはflattenで空間情報を失うが、再構成精度の向上に寄与する（付録B）。損失は入力と再構成のRMSE。
符号化パターン（風速・日射）は正規化の後、対象国の地理中心に合わせた2Dガウス核で畳み込み、k-meansでクラスタリングする。

b. 第1段階：空間パターン抽出（CNN-AE）
入力は64×128の経緯度格子。風速用と日射用の2つのCNN-AEを学習する。エンコーダは7層の畳み込みで、各層のフィルタ数は4, 8, 16, 32, 256, 32, 1。カーネルは3×3、ゼロパディングでサイズ維持。各層の活性化はReLU。最初の3層には2×2・stride 1のmax-poolingを適用し、寸法を段階的に半減。後段の4層はプーリング無しで接続。出力されるボトルネックの二次元符号化パターンは「16×8」（原文OCRでは「1638」と表記）である。
デコーダはFC（1024, 2048ニューロン）と4つの畳み込み層、間に3つのアップサンプリングを挟んで元の入力サイズに戻す。
学習ではERA5を80%/10%/10%の連続分割（学習/検証/テスト）とし、Adam最適化（Kingma and Ba 2014）、最大100エポック、バッチサイズ128。検証損失に基づくハイパーパラメータ（カーネル、層数、学習率など）選定。ドロップアウトは有効でなく、過学習の顕著な兆候も無し（付録B）。

c. 第2段階：気象パターンのクラスタリング（地域依存k-means）
Dunkelflauteは地理的に局在するため、空間情報を考慮した地域依存の重み付けを導入する。CNN-AEの二つの符号化パターン（風速・日射）を平均0・標準偏差1に正規化後、ガウス核で畳み込む。核は
f(x, y) = 1 / (2π s_x s_y) × exp{ - (x - m_x)^2 / (2 s_x^2) - (y - m_y)^2 / (2 s_y^2) }
で、(m_x, m_y)は対象地域の地理中心、s_x, s_yは地域の広がりパラメータ（ベルギーでは各1）。この畳み込み後のパターンをk-means（Lloyd 1982）で25クラスタに分割する（最適kは慣性とDavies–Bouldin指数で検討、付録C）。地域依存重みを使わない場合はパターンが拡散し国別の差異が識別しにくくなる（付録D）。SOMとの比較は付録E。

5. 結果
a. 特徴抽出（再構成精度）
図3は検証集合の例で、入力（左）・符号化（中央）・再構成（右）の風速・日射を示す。符号化は高値領域の位置・振幅など主要特徴を捉え、再構成も良好。検証集合全体でのRMSEは、風速0.78 m/s、日射24.62 W/m^2。データ全体の最大は風速約44.57 m/s、日射約1010.85 W/m^2、平均はそれぞれ7.77 m/sと123.46 W/m^2であり、誤差は中程度に低い。

図3: 検証集合の例（2018年5月14日16UTC、Dunkelflauteではない）。（上段）風速、（下段）日射。左: 原データ、中央: 符号化、右: 再構成。

b. 気象パターンのクラスタリング
図4に、ベルギー中心のガウス重みで25クラスタ（C1–C25）の10年平均に対する風速・日射の偏差を示す。各クラスタはベルギー周辺を焦点に異なる風速・日射の強度・広がりを持つ。視覚的検討から、C2, C9, C12, C18, C23がベルギー上空の同時低風速・低日射に最も対応しており、Dunkelflaute識別に有望（以下「トップ5」クラスタ）。
図5はトップ5各クラスタから2事例ずつ、実値の風速・日射を示す。いずれもベルギー周辺で低風速・低日射が明瞭。

図4: 25クラスタ（C1–C25）の10年平均からの風速・日射偏差。ガウス核はベルギー中心。

図5: トップ5各クラスタから無作為抽出した2事例の風速・日射の実値。

c. 識別と検証（ベルギー）
表1は、2013–2018年のベルギー集約発電データに基づくDunkelflauteの出現頻度（クラスタ別の時間比：DF time ratio）と、各クラスタ内でDunkelflauteとなる割合（positive ratio）、および各クラスタの平均設備利用率（風力・太陽光）を示す。ここでDF time ratioは、全Dunkelflaute時間のうち当該クラスタに属する割合を表す。12時間超（≥12 h）、24時間超（≥24 h）、全て（All）の3基準を併記。トップ5（C2, C9, C12, C18, C23）は、≥12 hで75%、≥24 hで69%、全体で68%を占めた。C9, C12, C23は、風・太陽の平均設備利用率が10%未満で、クラスタ内のpositive ratioも90%以上と高信頼なDunkelflaute指標である。C2, C18は太陽は低いが風がやや高く、相対的に指標としての信頼はやや低い。C10, C20, C21は平均設備利用率が閾値20%に近く、Dunkelflauteも一部含むが偽陽性が多くなるため本研究では除外した。
図6はトップ5各クラスタにおける風力・太陽光の設備利用率分布（正規化頻度）と95パーセンタイルを示す。C9, C12, C23では約95%が25%未満、C2, C18では多くが40%以内である。
図7は2017年1月のベルギーの風力・太陽光発電系列で、上段6パネルはC2, C9, C12, C18, C23、およびトップ5全体で識別されたDunkelflaute期間（灰色）、下段はEliaデータでの20%閾値に基づく真のDunkelflaute期間（灰色）を示す。高い一致が見られ、各クラスタが事象の一部区間を捉えている。

図6: トップ5各クラスタにおける設備利用率の正規化頻度と95%点（破線）。

図7: 2017年1月のベルギー風力・太陽光発電。上段の灰色は各クラスタ（およびトップ5）の識別期間、下段はElia基準による真のDunkelflaute期間。

d. 他国への適用
WISRnetは他国にも適用可能で、デンマーク、ドイツ、英国に展開した。図8は各国で代表的なDunkelflauteクラスタの風速・日射偏差で、対象国中心に広がる負偏差が明瞭。デンマークの例（図9）では25クラスタの平均偏差図からC1, C21, C24が代表的Dunkelflauteパターンとして抽出された。

図8: 対象国中心（左: デンマーク、中: ドイツ、右: 英国）のDunkelflauteクラスタの風速・日射偏差。

図9: デンマーク中心の25クラスタの風速・日射偏差（図4と同様の表現）。

6. 結論（Concluding remarks）
公開の風速・日射データ（例: 再解析）からDunkelflaute事象を識別する機械学習フレームワーク（WISRnet）を初めて提案・実証した。核となるのは二次元特徴抽出のCNN-AEと地域依存k-meansであり、この組み合わせにより位置特異的なDunkelflauteパターンの識別が可能となる。符号化パターンの抽出精度は高く、観測されたDunkelflaute期間とWISRnet識別期間の対応は極めて良好であった。ベルギーに焦点を当てたが、他国でも妥当性を示した。
今後の改善として、衛星観測など他の気象データの追加、MSLP・雲底高度・低層雲量などDunkelflauteに関連する変数の導入が考えられる。また、SOM等の他クラスタリングや空間重み付けの改良も有望である。さらに、CMIP5など気候投影と組み合わせれば、気候変動がDunkelflaute特性に与える影響の定量化が可能となり、次世代電力システムの設計・計画に資する。

謝辞:
第一著者は中国国家留学基金（CSC）に謝意を表する。

データ入手先:
- ベルギー集約発電量・設備容量: Elia（https://www.elia.be）
- ERA5再解析: ECMWF（https://cds.climate.copernicus.eu）

付録A. オートエンコーダ（AE）の概要
AEはエンコーダとデコーダからなり、入力x∈R^dを圧縮表現z∈R^sにマップし、再構成yを得る。
エンコーダ: z = f(x) = ϖ(W_e x + b1)
デコーダ: y = g(z) = φ(W_d z + b2)
パラメータu = {W_e, W_d, b1, b2}を再構成誤差J(u) = Σ_x L{x, g[f(x)]}（例: 二乗誤差）最小化で学習する。必要に応じて正則化を付加し、最適化は確率的勾配降下などで実施。

付録B. CNN実装と感度実験（TensorFlow–Keras）
対称（対称AE）と非対称（本研究）の両方を試験。代表構成として、対称のCNN3-FC1（Conv×3→Flatten→FC×1）、非対称のAsym-CNN5/7/10（Conv×5/7/10→FC×2→Conv×…）を比較。Convはすべて3×3、先頭3層はReLU＋max-pooling（2×2, stride 1）。Asym-CNN7（本論の構成）が最良の再構成精度。学習率0.001が最適で、0.005ではRMSE悪化、0.0005では改善せず。FC層のドロップアウト（0.5, 0.25）は有効でなくRMSE増大。FCのニューロン数を（1024, 2048）から（128, 256）に減らすとRMSEが顕著に悪化し、十分なFCの表現力が必要。学習曲線は約60エポック以降でRMSE低下が頭打ち（図B1）。

付録C. k-meansクラスタリングとクラスタ数の選定
k-meansは点と重心の二乗距離の総和（慣性）を最小化。クラスタ数Kの選定に、慣性（低いほど良い）とDavies–Bouldin指数（低いほど良い）を用いた。慣性はK=20–30付近で生産性が高く、K>30で改善が小さい。Davies–Bouldinは2で最小、その後は全体的に減少傾向だが最適Kの一意決定は困難。総合的にK=25を採用（図C1）。

付録D. ガウス核を用いない場合のk-means
ガウス重みを用いないと、低風速・低日射のクラスタは存在するものの、空間パターンが拡散して国ごとの差異が不明瞭になる（図D1）。地域依存の重み付けはクラスタ数の削減・分離性向上に有効。

付録E. 自己組織化マップ（SOM）との比較
SOMは非線形パターン抽出に強みを持つ教師なし法。MiniSom（5×5グリッド、学習率0.01、近傍1、反復100万）で風速・日射を標準化・連結してクラスタリングし、WISRnetと比較。2013–2018年のベルギー発電データに対するクラスタ内Dunkelflaute割合（positive ratio）の上位5クラスタはS1, S11, S16, S17, S21で、約65–79%がDunkelflaute。SOMは妥当だが、WISRnetはpositive ratioが90%超のクラスタが3つ、80%超が1つ、64%が1つと、識別精度で上回った。SOMにk-meansとガウス核重みを組み合わせる改善余地はあるが、本研究の範囲外。

参考文献:
本文に記載の通り（Abadi et al. 2016; Agostinelli et al. 2014; Badrinarayanan et al. 2017; Babar et al. 2019; Bao and Wallace 2015; Cassano et al. 2007; Chattopadhyay et al. 2020a,b; Cheneka et al. 2021; Cheng and Wallace 1993; Davies and Bouldin 1979; Denby 2020; Dong et al. 2016, 2018; Esteves et al. 2019; Fereday et al. 2008; Ferranti et al. 2015; Francis and Skific 2015; Gibson et al. 2017; Goodfellow et al. 2016; Grotjahn et al. 2016; Gulli and Pal 2017; Herman and Schumacher 2018; Hersbach et al. 2020; Hinton and Zemel 1994; Horton et al. 2015; Jain et al. 1999; Jiang et al. 2021; Jing and Tian 2020; Johnson et al. 2008; Kingma and Ba 2014; Kohonen 1990, 2013; Kolesnikov et al. 2019; Kotsiantis et al. 2007; Krizhevsky et al. 2012; LeCun et al. 2015; Lee and Feldstein 2013; Li et al. 2014, 2020, 2021a,b; Liu et al. 2016; Lloyd 1982; Loikith et al. 2017; McGovern et al. 2017; Meinke-Hubeny et al. 2017; Neal et al. 2016; Ohba et al. 2016; Pedregosa et al. 2011; Peng et al. 2020; Racah et al. 2016, 2017; Ranzato et al. 2007; Rasp and Lerch 2018; Sahai et al. 2017; Shalev-Shwartz and Ben-David 2014; Shi et al. 2017; Sianturi et al. 2020; Totz et al. 2017; Truyts and Vandervelden 2017; Vettigli 2018; Vigaud et al. 2018; Wang et al. 2018; Wetzel 2017; Xiao et al. 2019; Xu et al. 2017; Zanero and Savaresi 2004; Zhang et al. 2018）。

注記:
- 一部図表・数式・数値はPDF抽出時の体裁上の欠落や崩れがある可能性がありますが、本文の叙述・式・手順・主要数値は忠実に翻訳・記録しています。
- 「Unauthenticated | Downloaded ...」のページフッターは原PDFの自動付与であり、本文内容ではありません。
