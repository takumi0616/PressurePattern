Multi-scale structural similarity for image quality assessment（日本語訳）
種別: 会議論文（招待論文）
原著タイトル: Multiscale structural similarity for image quality assessment
著者: Zhou Wang¹, Eero P. Simoncelli¹, Alan C. Bovik²
所属:
¹ New York University, Center for Neural Science and Courant Institute of Mathematical Sciences, New York, NY 10003, USA
² University of Texas at Austin, Dept. of Electrical and Computer Engineering, Austin, TX 78712, USA
連絡先: zhouwang@ieee.org, eero.simoncelli@nyu.edu, bovik@ece.utexas.edu
出典: IEEE ACSSC 2003（DOI: 10.1109/ACSSC.2003.1292216）

概要（Abstract）
構造類似度（structural similarity）に基づく画像品質評価のパラダイムは、人間視覚系（HVS）が場面から構造情報を抽出することに高度に適応しているという仮定に基づく。そのため、構造類似度の指標は知覚画像品質の良い近似を提供しうる。本論文では、従来の単一スケール（single-scale）法よりも観視条件の変動を取り込む柔軟性を備えたマルチスケール構造類似（multi-scale structural similarity: MS-SSIM）法を提案する。種々スケールの相対的重要度を定めるパラメータを較正するための画像合成ベースの方法を開発する。実験比較により提案法の有効性を示す。

1. はじめに（Introduction）
客観的画像品質評価（objective IQA）の研究は、知覚品質を自動予測する品質尺度を設計することを目的とする。品質尺度は、画像取得、圧縮、通信、復元、強調、解析、表示、印刷、透かし入れ等の幅広い応用で重要な役割を果たす。最も広く用いられるフルリファレンス（FR）型の品質・歪み評価アルゴリズムは PSNR や MSE だが、知覚品質との相関は高くない（例 [1]–[6]）。

伝統的な知覚ベースの IQA はボトムアップのアプローチで、初期の HVS 機能を模擬しようとする。一般に、(1) 画像位置合わせ、点ごとの非線形変換、眼の光学系を模したローパス、色空間変換等を含みうる前処理、(2) 空間周波数および方位選択のサブバンドへの分解（チャネル分解）、(3) サブバンドごとの誤差に視覚感度の違い、チャネル内外の近傍係数による誤差感度変化を織り込む誤差正規化、(4) サブバンド誤差の誤差プーリング に分けられる。既知の心理物理的知見を取り込める一方、HVS は強く非線形で複雑であり、自然画像も極めて複雑であるにもかかわらず、多くの初期視覚モデルは単純刺激で特徴付けられた線形（あるいは準線形）演算に基づく。そのため強い仮定と一般化に依拠せざるを得ない [4], [5]。さらに多くの HVS 特徴を詰め込むにつれ、現実の応用、とりわけアルゴリズム最適化の文脈では扱いが過度に複雑になる。

構造類似（structural similarity）は、IQA に対する別個かつ補完的なアプローチを提供する [3]–[6]。これはトップダウンの仮定（HVS が場面から構造を抽出するのに高度適応）に基づき、構造類似の測度が知覚品質の良い近似になるという考えである。単純な実装（SSIM 指数）でも最先端の知覚品質指標を上回りうることが示されている [5]。ただし [5] の SSIM は単一スケール法であり、適切なスケールは観視条件（表示解像度、観視距離等）に依存するため、これは短所と考える。本稿ではマルチスケール SSIM（MS-SSIM）を提案し、スケール間の相対重要度を重みづけるパラメータを較正するための、画像合成に基づく新手法を導入する。

2. 単一スケールの構造類似（Single-Scale Structural Similarity）
x={x_i | i=1..N}, y={y_i | i=1..N} を整列済みの非負の離散信号（例えば、二つの画像の同一位置パッチ）とする。μ_x, σ²_x, σ_xy をそれぞれ x の平均・分散、x と y の共分散とする。概ね μ_x と σ_x は x の輝度・コントラスト推定、σ_xy は x と y の共変動傾向（構造類似の指標）と見なせる。[5] では輝度・コントラスト・構造比較を以下で与える：
l(x,y) = (2μ_x μ_y + C₁)/(μ_x² + μ_y² + C₁) … (1)
c(x,y) = (2σ_x σ_y + C₂)/(σ_x² + σ_y² + C₂) … (2)
s(x,y) = (σ_xy + C₃)/(σ_x σ_y + C₃) … (3)
C₁, C₂, C₃ は小定数で、
C₁=(K₁ L)², C₂=(K₂ L)², C₃=C₂/2 … (4)
L は画素ダイナミックレンジ（8bit 灰度で 255）、K₁, K₂ は 1 より十分小さい定数。構造類似の一般形：
SSIM(x,y) = [l(x,y)]^α · [c(x,y)]^β · [s(x,y)]^γ … (5)
α, β, γ は各成分の重要度。α=β=γ=1 とすれば
SSIM(x,y) = ((2μ_x μ_y+C₁)(2σ_xy+C₂))/((μ_x²+μ_y²+C₁)(σ_x²+σ_y²+C₂)) … (6)
この SSIM は (1) 対称性、(2) 上界性（≦1）、(3) 一意の最大（x=y の時のみ 1）を満たす。[3] の Universal Image Quality Index は C₁=C₂=0 の場合に相当するが、分母が 0 に近いと不安定になる問題がある。[5] では C₁, C₂（K₁=0.01, K₂=0.03）を導入して安定化。

実装ではスライディングウィンドウで SSIM マップを得、平滑窓で局所統計を算出してブロッキングを回避 [5]。平均 SSIM を全体品質とする。

3. マルチスケール構造類似（Multi-Scale Structural Similarity）
3.1 MS-SSIM 指数
画像詳細の可視性はサンプリング密度、観視距離、観察者の視覚能力に依存し、これらが変わると主観評価も変わる。単一スケール法は特定条件にしか適合しない可能性がある。マルチスケールは多解像度の詳細を取り込む便利な方法である。

提案法の系統図は Fig.1 の通り。参照・歪み画像にローパス＋2 倍間引きを反復適用。元画像を Scale 1、(M-1) 回の反復後を Scale M とする。j スケールで c_j(x,y)（式(2)）と s_j(x,y)（式(3)）を計算し、輝度比較 l_M(x,y)（式(1)）は最大スケール M のみで計算。多スケールの統合は
SSIM(x,y) = [l_M(x,y)]^{α_M} · Π_{j=1..M} [c_j(x,y)]^{β_j} [s_j(x,y)]^{γ_j} … (7)
α_M, β_j, γ_j は各成分・各スケールの重要度。単一スケール法は、Scale M まで縮小して α_M,β_M,γ_M のみ非ゼロとする特殊例である。簡単化のため α_j=β_j=γ_j、さらにスケール間正規化として Σ γ_j = 1 とし、異なる設定の比較可能性を確保する。残る課題はスケール間の相対値の決定である。概念的には HVS のコントラスト感度関数（CSF） [7] に関連するが、CSF は単純刺激・可視閾で計測されるため、そのままは用いにくい。

3.2 スケール間較正（Cross-scale calibration）
異スケールの相対重要度を較正するため、画像合成ベースのアプローチを用いる。類似の「分析に基づく合成（synthesis-by-analysis）」は統計的テクスチャモデルの主観評価で用いられ、モデルで元テクスチャと統計が一致する合成を行い、主観的な類似性判断を求める [8]–[11]。品質指標のデモにも定性的に用いられてきた [5], [12]。合成はモデル検証と改良案の示唆に有効である [11]。

8bit 灰度の原画像に対し、Fig.2 のようにスケールと歪みレベル（MSE）に対応する合成歪み画像の表を作る。各画像は、白色ガウス雑音を加えた初期値から、MSE を固定し、特定スケールにのみ歪みが生じるよう制約した勾配降下で「SSIM が最も悪化する」方向に探索して生成する。スケールは 5、歪みレベルは 12（2^3 から 2^14 まで）として 60 枚を作成（Fig.2）。同一 MSE 行内でも品質は大きく異なり、スケールごとに知覚重要度が異なることを示す。内容の異なる 10 枚の 64×64 原画像に対し、計 600 枚を生成。

8 名の被験者（著者 1 名含む、他は視覚の一般知識を有するが研究目的の詳細は不知）に対し、各セットごとに、5 スケール（列）から「同品質」と感じる 5 枚（各列 1 枚）を選択させた（例は Fig.2 のマーク）。全被験者・全画像で選択位置を平均。一般に、被験者間の一致は同一被験者の画像間一致より高かった。得られた結果を正規化（和を 1）し、式(7) の指数に割り当てた。最終パラメータは
β₁=γ₁=0.0448, β₂=γ₂=0.2856, β₃=γ₃=0.3001, β₄=γ₄=0.2363, α₅=β₅=γ₅=0.1333。

4. 実験結果（Test Results）
LIVE データベース [13] の 344 枚（JPEG/JPEG2000、典型 768×512）の圧縮画像で評価。ビットレートは 0.028–3.150 bpp。各画像の MOS は 13–25 名の平均。比較対象は PSNR、Sarnoff（JNDmetrix 8.0 [14]）、単一スケール SSIM（M=1〜5）、提案 MS-SSIM。

Fig.3 に MOS と各モデル出力の散布図を示す。定量評価として、VQEG Phase I FR-TV テスト [15] のロジスティック関数で主観・客観の非線形写像を行い、対応後の線形相関（CC）、平均絶対誤差（MAE）、二乗平均平方根誤差（RMS）を予測精度として算出。予測一貫性は ±2σ の範囲外の割合（外れ値率 OR）で定義。単調性はスピアマン順位相関（ROCC）。結果は表 1。

表1. LIVE JPEG/JPEG2000 における性能比較
（SS-SSIM: 単一スケール、MS-SSIM: マルチスケール、CC: 回帰後相関、ROCC: スピアマン、MAE, RMS, OR[%]）
PSNR: CC 0.905, ROCC 0.901, MAE 6.53, RMS 8.45, OR 15.7
Sarnoff: 0.956, 0.947, 4.66, 5.81, 13.20
SS-SSIM(M=1): 0.949, 0.945, 4.96, 6.25, 6.98
SS-SSIM(M=2): 0.963, 0.959, 4.21, 5.38, 2.62
SS-SSIM(M=3): 0.958, 0.956, 4.53, 5.67, 2.91
SS-SSIM(M=4): 0.948, 0.946, 4.99, 6.31, 5.81
SS-SSIM(M=5): 0.938, 0.936, 5.55, 6.88, 7.85
MS-SSIM: 0.969, 0.966, 3.86, 4.91, 1.16

散布図・定量評価から、単一スケール SSIM の性能はスケールで変動し最良は M=2 だった。またスケールを上げるほど単一スケール SSIM のスコアは高く出やすい傾向が見られた。これは、圧縮（JPEG/JPEG2000）が細かいスケールをより強く劣化させ、粗いスケールでは元画像に近く見えるためである。全評価基準で、MS-SSIM は全モデル（最良の単一スケールを含む）を上回り、スケール間の意味あるバランスを示した。

5. 議論（Discussions）
提案した MS-SSIM は、画像解像度・観視条件の変動取り込みにおいて単一スケールより柔軟である。適切なパラメータ設定により、MS-SSIM は最良の単一スケール SSIM や最先端の品質指標を上回る性能を示した。

トップダウン型品質モデル（構造類似ベース等）の開発における最大の課題は、モデルパラメータの較正である。これらは抽象的で、ボトムアップモデルのように単純刺激の主観実験から直接導くのは難しい。本稿ではスケール間重要度を定めるパラメータの較正に画像合成法を用いた。単一からマルチへの改善は、この新手法の有用性を示唆する。ただし本手法はまだ粗く、より体系的に洗練して、広範な応用に展開していく予定である。

6. 参考文献（References）
[1] A. M. Eskicioglu and P. S. Fisher, IEEE Trans. Comm., 43, 2959–2965, 1995.
[2] T. N. Pappas and R. J. Safranek, in Handbook of Image and Video Proc., Academic Press, 2000.
[3] Z. Wang and A. C. Bovik, IEEE SPL, 9, 81–84, 2002.
[4] Z. Wang, H. R. Sheikh, and A. C. Bovik, in The Handbook of Video Databases, CRC Press, 2003.
[5] Z. Wang, A. C. Bovik, H. R. Sheikh, E. P. Simoncelli, IEEE TIP, 13, 2004.
[6] Z. Wang, L. Lu, A. C. Bovik, SP: Image Comm., 19, 2004.
[7] B. A. Wandell, Foundations of Vision, 1995.
[8] O. D. Faugeras, W. K. Pratt, IEEE PAMI, 2(4), 1980.
[9] A. Gagalowicz, IEEE PAMI, 3(5), 1981.
[10] D. Heeger, J. Bergen, Proc. SIGGRAPH, 1995.
[11] J. Portilla, E. P. Simoncelli, IJCV, 40, 49–71, 2000.
[12] P. C. Teo, D. J. Heeger, Proc. SPIE 2179, 1994.
[13] H. R. Sheikh, Z. Wang, A. C. Bovik, L. K. Cormack, http://live.ece.utexas.edu/research/quality/
[14] Sarnoff, JNDmetrix, http://www.sarnoff.com/products_services/video_vision/jndmetrix/
[15] VQEG Final Report, 2000, http://www.vqeg.org/

図について（本文言及）
Fig.1: MS-SSIM の処理系統図（各スケールで L: ローパス、2↓: 2 倍間引き、c_j, s_j、最大スケールで l_M）
Fig.2: スケール別・MSE 別の合成歪み画像表（同列がスケール、同行が MSE。同品質と選ばれた例がマーク）
Fig.3: LIVE データベースにおける MOS と各モデル出力の散布図（(a) PSNR, (b) Sarnoff, (c)-(g) 単一スケール SSIM (M=1..5), (h) MS-SSIM）

付記
本訳は PDF から抽出された本文・式・表を忠実に反映し、日本語で正確に記述した。式 (1)–(7) の記号・定数の定義は原文に準拠し、図表は本文の記述として再現した。
