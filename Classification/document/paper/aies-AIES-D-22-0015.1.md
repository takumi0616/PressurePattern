タイトル: “Dunkelflaute（暗黒無風）”事象の自動識別：畳み込みニューラルネットワーク（CNN）ベースのオートエンコーダ手法

著者:

- Bowen Li (a)
- Sukanta Basu (a)
- Simon J. Watson (b)
  所属:
  a. Faculty of Civil Engineering and Geosciences, Delft University of Technology, Delft, Netherlands
  b. Faculty of Aerospace Engineering, Delft University of Technology, Delft, Netherlands

原稿受理歴:

- 受理: 2022 年 2 月 11 日
- 最終版: 2022 年 8 月 7 日

掲載誌・DOI・権利:

- Artificial Intelligence for the Earth Systems（AIES）
- DOI: 10.1175/AIES-D-22-0015.1
- ©2022 American Meteorological Society（AMS）。再利用・著作権情報は AMS Copyright Policy（www.ametsoc.org/PUBSReuseLicenses）を参照

キーワード: 再生可能エネルギー；クラスタリング；深層学習

要旨（Abstract）:
欧州のエネルギーシステムにおける風力・太陽光の重要性が増すにつれ、「Dunkelflaute（長時間の無風・曇天）」のような不利な気象条件が系統運用に大きな課題をもたらす。そのため、再解析・数値天気予報・気候投影といったオープンデータから、こうした事象を正確に同定・特徴付けることが重要となる。本研究では、風速と日射の空間パターンを自動的に符号化し、そこから Dunkelflaute 期間を識別する二段階の教師なし深層学習フレームワーク（WISRnet: wind and solar network）を提案する。第 1 段階では、深い畳み込みニューラルネットワーク（CNN）ベースのオートエンコーダ（AE）により、二次元の空間パターンから特徴抽出を行う。得られる CNN-AE の二次元符号化パターンは、振幅と空間情報を簡潔に内包する。第 2 段階では、k-means アルゴリズムの一種を用いて、これら CNN-AE パターンを地域依存の気象クラスタに分割する。検証として、ベルギーの集約風力・太陽光発電量データを用い、既往研究の単純基準に基づき 6 年分データから Dunkelflaute 期間を直接同定し、各期間を WISRnet 由来のクラスタに対応付けた。その結果、Dunkelflaute 期間の大半は 25 クラスタ中 5 つのクラスタのみに属することが分かった。専有の発電量データがなくとも、WISRnet は公開気象データから Dunkelflaute 期間を識別可能であることを示し、さらにデンマーク、スウェーデン、英国に展開して事象の識別・特徴付けを実証した。

1. 序論（Introduction）
   風力・太陽光が欧州の電力システムで主要な供給源となるにつれ、発電に大きく影響する極端気象の同定・特徴付けが重要となる。Dunkelflaute（同時に低い風力・太陽光発電量となる事象）は、北欧諸国で冬季に複数日持続することがあり、需給バランスに課題をもたらす。そのため、Dunkelflaute の信頼できる識別・特徴付け、さらには予測の枠組みが必要である。
   先行研究（Li et al. 2021a,b）は、メソスケールモデルの再現性評価や、北海・バルト海周辺諸国の Dunkelflaute 簡易気候学を示したが、識別には専有の発電量データを用いた。再生可能エネルギー産業は新しく、各国で長期の発電量データが十分に公開されていない。一方、再解析・数値予報・気候投影などの格子化気象データは長期・公開である。本研究は、これらオープンデータを取り込み、自動的に Dunkelflaute を識別する機械学習（ML）手法を開発する。

2. 関連する機械学習アルゴリズムの概観
   機械学習は、入力データから有用情報を自動抽出したりタスクを学習したりする枠組みで、教師ありと教師なしがある。本研究はラベルがないため教師なし手法を採用する。
   大気科学では、k-means、階層クラスタリング、自己組織化マップ（SOM）などの教師なしクラスタリングが総観パターン分類や極端温度の傾向解析、予報支援、極端パターン同定、風力予測などで用いられてきた。一方、教師あり CNN は画像・動画など多次元データから表現的特徴を自動学習し、地球科学でも雲・氷晶・地表分類・火山変動などで高精度を示す。ただし多くの応用でラベルが得られないため、教師なし CNN の必要性がある。近年は自己教師あり学習も台頭している。
   高次元特徴ベクトルのクラスタリングは、多様なノイズや非線形・非定常、マルチスケール性のため困難になりがちである。過学習や汎化低下を避けるため、ラベル不要で高次元入力から重要特徴を抽出するオートエンコーダ（AE）が有効である。大気科学でも CNN-AE によるパターン・極端のクラスタリングが報告されている。本研究は新しい CNN-AE で風速・日射の空間パターンを低次元に圧縮し（二次元の符号化パターン）、その後に k-means でクラスタリングする。

図 1: 2017 年 1 月 16 日 12UTC の（左）100 m 風速、（右）下向き短波放射（日射）。この日はベルギーで Dunkelflaute が発生し再エネ発電が大幅に不足した。

図 2: 提案する WISRnet フレームワークの概念図。

3. データセットの説明
   地上観測の風速・日射は疎で記録が短く、地形影響や測定誤差もあるため、本概念実証では ECMWF 再解析 ERA5（Hersbach et al. 2020）を用いる。ERA5 は時間（毎時）・空間（約 31 km）解像度が高く、Dunkelflaute 研究でも有用性が示されている。
   用いる変数は、地上から 100 m の毎時風速、地表の下向き短波放射（日射）で、期間は 2009–2018 年（標本数 86904）。領域は北海と隣接国（46.75°–62.5°N, 12°W–19.75°E；64×128 格子）に焦点。図 1 は 2017 年 1 月 16 日の Dunkelflaute 例で、ベルギーの再エネ発電が大きく低下した。
   検証にはベルギーの集約風力・太陽光発電量データ（Elia）を使用し、発電データの入手可能期間に合わせ 2013–2018 年を対象とする。15 分値を毎時に集約し、Li et al. (2021a)の定義（風力・太陽光のそれぞれの設備利用率が 20%を同時に下回る 1 時間）で Dunkelflaute をラベル付けする。既報では 1 日超の Dunkelflaute は主に拡張冬季（10–2 月）に発生。

4. 方法論
   a. WISRnet フレームワークの概要
   図 2 に示す深層学習アーキテクチャにより、気象パターンをクラスタリングし Dunkelflaute を識別する。風速と日射は別々に CNN-AE へ入力され、エンコーダ（7 畳み込み層）が入力の特徴を符号化し、ボトルネック層として二次元パターンを出力する。一般に 1 次元全結合（FC）をボトルネックにする例が多いが、二次元の符号化パターンは地理座標上に容易に投影でき、空間的重み（例: 二次元ガウス核）との畳み込みが行いやすい。空間関係の把握に適するため本研究は 2D ボトルネック層を採用する。
   デコーダは二層の FC と五層の畳み込みで入力の再構成を行う（非対称 AE）。FC は flatten で空間情報を失うが、再構成精度の向上に寄与する（付録 B）。損失は入力と再構成の RMSE。
   符号化パターン（風速・日射）は正規化の後、対象国の地理中心に合わせた 2D ガウス核で畳み込み、k-means でクラスタリングする。

b. 第 1 段階：空間パターン抽出（CNN-AE）
入力は 64×128 の経緯度格子。風速用と日射用の 2 つの CNN-AE を学習する。エンコーダは 7 層の畳み込みで、各層のフィルタ数は 4, 8, 16, 32, 256, 32, 1。カーネルは 3×3、ゼロパディングでサイズ維持。各層の活性化は ReLU。最初の 3 層には 2×2・stride 1 の max-pooling を適用し、寸法を段階的に半減。後段の 4 層はプーリング無しで接続。出力されるボトルネックの二次元符号化パターンは「16×8」（原文 OCR では「1638」と表記）である。
デコーダは FC（1024, 2048 ニューロン）と 4 つの畳み込み層、間に 3 つのアップサンプリングを挟んで元の入力サイズに戻す。
学習では ERA5 を 80%/10%/10%の連続分割（学習/検証/テスト）とし、Adam 最適化（Kingma and Ba 2014）、最大 100 エポック、バッチサイズ 128。検証損失に基づくハイパーパラメータ（カーネル、層数、学習率など）選定。ドロップアウトは有効でなく、過学習の顕著な兆候も無し（付録 B）。

c. 第 2 段階：気象パターンのクラスタリング（地域依存 k-means）
Dunkelflaute は地理的に局在するため、空間情報を考慮した地域依存の重み付けを導入する。CNN-AE の二つの符号化パターン（風速・日射）を平均 0・標準偏差 1 に正規化後、ガウス核で畳み込む。核は
f(x, y) = 1 / (2π s_x s_y) × exp{ - (x - m_x)^2 / (2 s_x^2) - (y - m_y)^2 / (2 s_y^2) }
で、(m_x, m_y)は対象地域の地理中心、s_x, s_y は地域の広がりパラメータ（ベルギーでは各 1）。この畳み込み後のパターンを k-means（Lloyd 1982）で 25 クラスタに分割する（最適 k は慣性と Davies–Bouldin 指数で検討、付録 C）。地域依存重みを使わない場合はパターンが拡散し国別の差異が識別しにくくなる（付録 D）。SOM との比較は付録 E。

5. 結果
   a. 特徴抽出（再構成精度）
   図 3 は検証集合の例で、入力（左）・符号化（中央）・再構成（右）の風速・日射を示す。符号化は高値領域の位置・振幅など主要特徴を捉え、再構成も良好。検証集合全体での RMSE は、風速 0.78 m/s、日射 24.62 W/m^2。データ全体の最大は風速約 44.57 m/s、日射約 1010.85 W/m^2、平均はそれぞれ 7.77 m/s と 123.46 W/m^2 であり、誤差は中程度に低い。

図 3: 検証集合の例（2018 年 5 月 14 日 16UTC、Dunkelflaute ではない）。（上段）風速、（下段）日射。左: 原データ、中央: 符号化、右: 再構成。

b. 気象パターンのクラスタリング
図 4 に、ベルギー中心のガウス重みで 25 クラスタ（C1–C25）の 10 年平均に対する風速・日射の偏差を示す。各クラスタはベルギー周辺を焦点に異なる風速・日射の強度・広がりを持つ。視覚的検討から、C2, C9, C12, C18, C23 がベルギー上空の同時低風速・低日射に最も対応しており、Dunkelflaute 識別に有望（以下「トップ 5」クラスタ）。
図 5 はトップ 5 各クラスタから 2 事例ずつ、実値の風速・日射を示す。いずれもベルギー周辺で低風速・低日射が明瞭。

図 4: 25 クラスタ（C1–C25）の 10 年平均からの風速・日射偏差。ガウス核はベルギー中心。

図 5: トップ 5 各クラスタから無作為抽出した 2 事例の風速・日射の実値。

c. 識別と検証（ベルギー）
表 1 は、2013–2018 年のベルギー集約発電データに基づく Dunkelflaute の出現頻度（クラスタ別の時間比：DF time ratio）と、各クラスタ内で Dunkelflaute となる割合（positive ratio）、および各クラスタの平均設備利用率（風力・太陽光）を示す。ここで DF time ratio は、全 Dunkelflaute 時間のうち当該クラスタに属する割合を表す。12 時間超（≥12 h）、24 時間超（≥24 h）、全て（All）の 3 基準を併記。トップ 5（C2, C9, C12, C18, C23）は、≥12 h で 75%、≥24 h で 69%、全体で 68%を占めた。C9, C12, C23 は、風・太陽の平均設備利用率が 10%未満で、クラスタ内の positive ratio も 90%以上と高信頼な Dunkelflaute 指標である。C2, C18 は太陽は低いが風がやや高く、相対的に指標としての信頼はやや低い。C10, C20, C21 は平均設備利用率が閾値 20%に近く、Dunkelflaute も一部含むが偽陽性が多くなるため本研究では除外した。
図 6 はトップ 5 各クラスタにおける風力・太陽光の設備利用率分布（正規化頻度）と 95 パーセンタイルを示す。C9, C12, C23 では約 95%が 25%未満、C2, C18 では多くが 40%以内である。
図 7 は 2017 年 1 月のベルギーの風力・太陽光発電系列で、上段 6 パネルは C2, C9, C12, C18, C23、およびトップ 5 全体で識別された Dunkelflaute 期間（灰色）、下段は Elia データでの 20%閾値に基づく真の Dunkelflaute 期間（灰色）を示す。高い一致が見られ、各クラスタが事象の一部区間を捉えている。

図 6: トップ 5 各クラスタにおける設備利用率の正規化頻度と 95%点（破線）。

図 7: 2017 年 1 月のベルギー風力・太陽光発電。上段の灰色は各クラスタ（およびトップ 5）の識別期間、下段は Elia 基準による真の Dunkelflaute 期間。

d. 他国への適用
WISRnet は他国にも適用可能で、デンマーク、ドイツ、英国に展開した。図 8 は各国で代表的な Dunkelflaute クラスタの風速・日射偏差で、対象国中心に広がる負偏差が明瞭。デンマークの例（図 9）では 25 クラスタの平均偏差図から C1, C21, C24 が代表的 Dunkelflaute パターンとして抽出された。

図 8: 対象国中心（左: デンマーク、中: ドイツ、右: 英国）の Dunkelflaute クラスタの風速・日射偏差。

図 9: デンマーク中心の 25 クラスタの風速・日射偏差（図 4 と同様の表現）。

6. 結論（Concluding remarks）
   公開の風速・日射データ（例: 再解析）から Dunkelflaute 事象を識別する機械学習フレームワーク（WISRnet）を初めて提案・実証した。核となるのは二次元特徴抽出の CNN-AE と地域依存 k-means であり、この組み合わせにより位置特異的な Dunkelflaute パターンの識別が可能となる。符号化パターンの抽出精度は高く、観測された Dunkelflaute 期間と WISRnet 識別期間の対応は極めて良好であった。ベルギーに焦点を当てたが、他国でも妥当性を示した。
   今後の改善として、衛星観測など他の気象データの追加、MSLP・雲底高度・低層雲量など Dunkelflaute に関連する変数の導入が考えられる。また、SOM 等の他クラスタリングや空間重み付けの改良も有望である。さらに、CMIP5 など気候投影と組み合わせれば、気候変動が Dunkelflaute 特性に与える影響の定量化が可能となり、次世代電力システムの設計・計画に資する。

謝辞:
第一著者は中国国家留学基金（CSC）に謝意を表する。

データ入手先:

- ベルギー集約発電量・設備容量: Elia（https://www.elia.be）
- ERA5 再解析: ECMWF（https://cds.climate.copernicus.eu）

付録 A. オートエンコーダ（AE）の概要
AE はエンコーダとデコーダからなり、入力 x∈R^d を圧縮表現 z∈R^s にマップし、再構成 y を得る。
エンコーダ: z = f(x) = ϖ(W_e x + b1)
デコーダ: y = g(z) = φ(W_d z + b2)
パラメータ u = {W_e, W_d, b1, b2}を再構成誤差 J(u) = Σ_x L{x, g[f(x)]}（例: 二乗誤差）最小化で学習する。必要に応じて正則化を付加し、最適化は確率的勾配降下などで実施。

付録 B. CNN 実装と感度実験（TensorFlow–Keras）
対称（対称 AE）と非対称（本研究）の両方を試験。代表構成として、対称の CNN3-FC1（Conv×3→Flatten→FC×1）、非対称の Asym-CNN5/7/10（Conv×5/7/10→FC×2→Conv×…）を比較。Conv はすべて 3×3、先頭 3 層は ReLU ＋ max-pooling（2×2, stride 1）。Asym-CNN7（本論の構成）が最良の再構成精度。学習率 0.001 が最適で、0.005 では RMSE 悪化、0.0005 では改善せず。FC 層のドロップアウト（0.5, 0.25）は有効でなく RMSE 増大。FC のニューロン数を（1024, 2048）から（128, 256）に減らすと RMSE が顕著に悪化し、十分な FC の表現力が必要。学習曲線は約 60 エポック以降で RMSE 低下が頭打ち（図 B1）。

付録 C. k-means クラスタリングとクラスタ数の選定
k-means は点と重心の二乗距離の総和（慣性）を最小化。クラスタ数 K の選定に、慣性（低いほど良い）と Davies–Bouldin 指数（低いほど良い）を用いた。慣性は K=20–30 付近で生産性が高く、K>30 で改善が小さい。Davies–Bouldin は 2 で最小、その後は全体的に減少傾向だが最適 K の一意決定は困難。総合的に K=25 を採用（図 C1）。

付録 D. ガウス核を用いない場合の k-means
ガウス重みを用いないと、低風速・低日射のクラスタは存在するものの、空間パターンが拡散して国ごとの差異が不明瞭になる（図 D1）。地域依存の重み付けはクラスタ数の削減・分離性向上に有効。

付録 E. 自己組織化マップ（SOM）との比較
SOM は非線形パターン抽出に強みを持つ教師なし法。MiniSom（5×5 グリッド、学習率 0.01、近傍 1、反復 100 万）で風速・日射を標準化・連結してクラスタリングし、WISRnet と比較。2013–2018 年のベルギー発電データに対するクラスタ内 Dunkelflaute 割合（positive ratio）の上位 5 クラスタは S1, S11, S16, S17, S21 で、約 65–79%が Dunkelflaute。SOM は妥当だが、WISRnet は positive ratio が 90%超のクラスタが 3 つ、80%超が 1 つ、64%が 1 つと、識別精度で上回った。SOM に k-means とガウス核重みを組み合わせる改善余地はあるが、本研究の範囲外。

参考文献:
本文に記載の通り（Abadi et al. 2016; Agostinelli et al. 2014; Badrinarayanan et al. 2017; Babar et al. 2019; Bao and Wallace 2015; Cassano et al. 2007; Chattopadhyay et al. 2020a,b; Cheneka et al. 2021; Cheng and Wallace 1993; Davies and Bouldin 1979; Denby 2020; Dong et al. 2016, 2018; Esteves et al. 2019; Fereday et al. 2008; Ferranti et al. 2015; Francis and Skific 2015; Gibson et al. 2017; Goodfellow et al. 2016; Grotjahn et al. 2016; Gulli and Pal 2017; Herman and Schumacher 2018; Hersbach et al. 2020; Hinton and Zemel 1994; Horton et al. 2015; Jain et al. 1999; Jiang et al. 2021; Jing and Tian 2020; Johnson et al. 2008; Kingma and Ba 2014; Kohonen 1990, 2013; Kolesnikov et al. 2019; Kotsiantis et al. 2007; Krizhevsky et al. 2012; LeCun et al. 2015; Lee and Feldstein 2013; Li et al. 2014, 2020, 2021a,b; Liu et al. 2016; Lloyd 1982; Loikith et al. 2017; McGovern et al. 2017; Meinke-Hubeny et al. 2017; Neal et al. 2016; Ohba et al. 2016; Pedregosa et al. 2011; Peng et al. 2020; Racah et al. 2016, 2017; Ranzato et al. 2007; Rasp and Lerch 2018; Sahai et al. 2017; Shalev-Shwartz and Ben-David 2014; Shi et al. 2017; Sianturi et al. 2020; Totz et al. 2017; Truyts and Vandervelden 2017; Vettigli 2018; Vigaud et al. 2018; Wang et al. 2018; Wetzel 2017; Xiao et al. 2019; Xu et al. 2017; Zanero and Savaresi 2004; Zhang et al. 2018）。

注記:

- 一部図表・数式・数値は PDF 抽出時の体裁上の欠落や崩れがある可能性がありますが、本文の叙述・式・手順・主要数値は忠実に翻訳・記録しています。
- 「Unauthenticated | Downloaded ...」のページフッターは原 PDF の自動付与であり、本文内容ではありません。
